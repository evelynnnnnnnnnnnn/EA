{"version":3,"file":"chat-content.bundle.js","sources":["../src/components/content/base/const/size.js","../src/components/content/base/components/chat-header/components/call-button/types/call-types.js","../src/components/content/base/components/chat-header/components/call-button/classes/call-menu.js","../src/components/content/base/components/chat-header/components/call-button/call-button.js","../src/components/content/base/components/chat-header/components/entity-link/const/chat-type-params.js","../src/components/content/base/components/chat-header/components/entity-link/entity-link.js","../src/components/content/base/components/chat-header/components/title/group-chat.js","../src/components/content/base/components/chat-header/components/title/user.js","../src/components/content/base/components/chat-header/components/title/multidialog.js","../src/components/content/base/components/chat-header/chat-header.js","../src/components/content/base/components/drop-area.js","../src/components/content/base/components/mute-panel.js","../src/components/content/base/components/join-panel.js","../src/components/content/base/components/loading-bar.js","../src/components/content/base/utils/observer-directive.js","../src/components/content/base/base.js","../src/components/content/channel/components/comments-button.js","../src/components/content/channel/classes/message-menu.js","../src/components/content/channel/components/message-list.js","../src/components/content/channel/components/dialog.js","../src/components/content/channel/components/header.js","../src/components/content/channel/components/join-panel.js","../src/components/content/channel/components/textarea.js","../src/components/content/channel/channel.js","../src/components/openers/chat/components/empty-state.js","../src/components/openers/chat/classes/user-service.js","../src/components/openers/chat/chat.js","../src/components/content/comments/classes/comments-service.js","../src/components/content/comments/components/follow-toggle.js","../src/components/content/comments/components/header.js","../src/components/content/comments/components/dialog-loader.js","../src/components/content/comments/classes/message-menu.js","../src/components/content/comments/components/message-list.js","../src/components/content/comments/components/dialog.js","../src/components/content/comments/components/textarea.js","../src/components/content/comments/components/join-panel.js","../src/components/content/comments/comments.js","../src/components/openers/comments/comments.js","../src/chat-content.js"],"sourcesContent":["export const Height = {\n\tchatHeader: 64,\n\tpinnedMessages: 53,\n\tblockedTextarea: 50,\n\tdropAreaOffset: 16,\n};\n","import { Core } from 'im.v2.application.core';\nimport { Messenger } from 'im.public';\nimport { CallManager } from 'im.v2.lib.call';\n\nimport type { ImModelChat } from 'im.v2.model';\n\nexport const CallTypes = {\n\tvideo: {\n\t\tid: 'video',\n\t\tlocCode: 'IM_CONTENT_CHAT_HEADER_VIDEOCALL',\n\t\tstart: (dialogId: string) => {\n\t\t\tMessenger.startVideoCall(dialogId);\n\t\t},\n\t},\n\taudio: {\n\t\tid: 'audio',\n\t\tlocCode: 'IM_CONTENT_CHAT_HEADER_CALL_MENU_AUDIO',\n\t\tstart: (dialogId: string) => {\n\t\t\tMessenger.startVideoCall(dialogId, false);\n\t\t},\n\t},\n\tbeta: {\n\t\tid: 'beta',\n\t\tlocCode: 'IM_CONTENT_CHAT_HEADER_CALL_MENU_BETA_2',\n\t\tstart: (dialogId: string) => {\n\t\t\tconst dialog: ImModelChat = Core.getStore().getters['chats/get'](dialogId);\n\t\t\tCallManager.getInstance().createBetaCallRoom(dialog.chatId);\n\t\t},\n\t},\n};\n","import { Loc, Tag, Extension } from 'main.core';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { ChatActionType, ChatType, RestMethod } from 'im.v2.const';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { CallManager } from 'im.v2.lib.call';\nimport { runAction } from 'im.v2.lib.rest';\n\nimport { CallTypes } from '../types/call-types';\n\nimport type { ImModelChat, ImModelUser } from 'im.v2.model';\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { PopupOptions } from 'main.popup';\n\nexport class CallMenu extends BaseMenu\n{\n\tcontext: ImModelChat;\n\n\tstatic events = {\n\t\tonMenuItemClick: 'onMenuItemClick',\n\t};\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-chat-header-call-menu';\n\t}\n\n\tgetMenuOptions(): PopupOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 4,\n\t\t\toffsetTop: 5,\n\t\t};\n\t}\n\n\tgetMenuClassName(): String\n\t{\n\t\treturn 'bx-im-messenger__scope bx-im-chat-header-call-button__scope';\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.#getVideoCallItem(),\n\t\t\tthis.#getAudioCallItem(),\n\t\t\tthis.#getZoomItem(),\n\t\t\tthis.#getDelimiter(),\n\t\t\tthis.#getPersonalPhoneItem(),\n\t\t\tthis.#getWorkPhoneItem(),\n\t\t\tthis.#getInnerPhoneItem(),\n\t\t];\n\t}\n\n\t#getDelimiter(): MenuItem\n\t{\n\t\treturn { delimiter: true };\n\t}\n\n\t#getVideoCallItem(): MenuItem\n\t{\n\t\tconst isAvailable = this.#isCallAvailable(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_CONTENT_CHAT_HEADER_VIDEOCALL'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tCallTypes.video.start(this.context.dialogId);\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.video);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\tdisabled: !isAvailable,\n\t\t};\n\t}\n\n\t#getAudioCallItem(): MenuItem\n\t{\n\t\tconst isAvailable = this.#isCallAvailable(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_AUDIO'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tCallTypes.audio.start(this.context.dialogId);\n\n\t\t\t\tthis.emit(CallMenu.events.onMenuItemClick, CallTypes.audio);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\tdisabled: !isAvailable,\n\t\t};\n\t}\n\n\t#getPersonalPhoneItem(): ?MenuItem\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { phones } = this.#getUser();\n\t\tif (!phones.personalMobile)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_PERSONAL_PHONE');\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-no-icon bx-im-chat-header-call-button-menu__item',\n\t\t\thtml: this.#getUserPhoneHtml(title, phones.personalMobile),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.startPhoneCall(phones.personalMobile);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getWorkPhoneItem(): ?MenuItem\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { phones } = this.#getUser();\n\t\tif (!phones.workPhone)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_WORK_PHONE');\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-no-icon bx-im-chat-header-call-button-menu__item',\n\t\t\thtml: this.#getUserPhoneHtml(title, phones.workPhone),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.startPhoneCall(phones.workPhone);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getInnerPhoneItem(): ?MenuItem\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst { phones } = this.#getUser();\n\t\tif (!phones.innerPhone)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_INNER_PHONE_MSGVER_1');\n\n\t\treturn {\n\t\t\tclassName: 'menu-popup-no-icon bx-im-chat-header-call-button-menu__item',\n\t\t\thtml: this.#getUserPhoneHtml(title, phones.innerPhone),\n\t\t\tonclick: () => {\n\t\t\t\tMessenger.startPhoneCall(phones.innerPhone);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getZoomItem(): ?MenuItem\n\t{\n\t\tconst settings = Extension.getSettings('im.v2.component.content.chat');\n\t\tconst isActive = settings.get('isZoomActive', false);\n\t\tif (!isActive)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst classNames = ['bx-im-chat-header-call-button-menu__zoom', 'menu-popup-no-icon'];\n\t\tconst isFeatureAvailable = settings.get('isZoomFeatureAvailable', false);\n\t\tif (!isFeatureAvailable)\n\t\t{\n\t\t\tclassNames.push('--disabled');\n\t\t}\n\n\t\treturn {\n\t\t\tclassName: classNames.join(' '),\n\t\t\ttext: Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_ZOOM'),\n\t\t\tonclick: () => {\n\t\t\t\tif (!isFeatureAvailable)\n\t\t\t\t{\n\t\t\t\t\tBX.UI.InfoHelper.show('limit_video_conference_zoom');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#requestCreateZoomConference(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getUserPhoneHtml(title, phoneNumber): HTMLSpanElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span class=\"bx-im-chat-header-call-button-menu__phone_container\">\n\t\t\t\t<span class=\"bx-im-chat-header-call-button-menu__phone_title\">${title}</span>\n\t\t\t\t<span class=\"bx-im-chat-header-call-button-menu__phone_number\">${phoneNumber}</span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#isCallAvailable(dialogId: String): boolean\n\t{\n\t\tif (\n\t\t\tCore.getStore().getters['recent/calls/hasActiveCall'](dialogId)\n\t\t\t&& CallManager.getInstance().getCurrentCallDialogId() === dialogId\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (Core.getStore().getters['recent/calls/hasActiveCall']())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst chatCanBeCalled = CallManager.getInstance().chatCanBeCalled(dialogId);\n\t\tconst chatIsAllowedToCall = PermissionManager.getInstance().canPerformAction(ChatActionType.call, dialogId);\n\n\t\treturn chatCanBeCalled && chatIsAllowedToCall;\n\t}\n\n\t#getUser(): ?ImModelUser\n\t{\n\t\tif (!this.#isUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Core.getStore().getters['users/get'](this.context.dialogId);\n\t}\n\n\t#isUser(): true\n\t{\n\t\treturn this.context.type === ChatType.user;\n\t}\n\n\t#requestCreateZoomConference(dialogId: string)\n\t{\n\t\trunAction(RestMethod.imV2CallZoomCreate, { data: { dialogId } })\n\t\t\t.catch((errors) => {\n\t\t\t\tlet errorText = Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_ZOOM_CREATE_ERROR');\n\n\t\t\t\tconst notConnected = errors.some((error) => error.code === 'ZOOM_CONNECTED_ERROR');\n\t\t\t\tif (notConnected)\n\t\t\t\t{\n\t\t\t\t\tconst userProfileUri = `/company/personal/user/${Core.getUserId()}/social_services/`;\n\t\t\t\t\terrorText = Loc.getMessage('IM_CONTENT_CHAT_HEADER_CALL_MENU_ZOOM_CONNECT_ERROR')\n\t\t\t\t\t\t.replace('#HREF_START#', `<a href=${userProfileUri}>`)\n\t\t\t\t\t\t.replace('#HREF_END#', '</>');\n\t\t\t\t}\n\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: errorText,\n\t\t\t\t});\n\t\t\t});\n\t}\n}\n","import { Extension } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nimport { Messenger } from 'im.public';\nimport { Core } from 'im.v2.application.core';\nimport { ChatActionType, LocalStorageKey, ChatType } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { LocalStorageManager } from 'im.v2.lib.local-storage';\n\nimport { CallMenu } from './classes/call-menu';\nimport { CallTypes } from './types/call-types';\n\nimport './css/call-button.css';\n\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const CallButton = {\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tlastCallType: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisActive(): boolean\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.$store.getters['recent/calls/hasActiveCall'](this.dialogId)\n\t\t\t\t&& CallManager.getInstance().getCurrentCallDialogId() === this.dialogId\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.$store.getters['recent/calls/hasActiveCall']())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst chatCanBeCalled = CallManager.getInstance().chatCanBeCalled(this.dialogId);\n\t\t\tconst chatIsAllowedToCall = PermissionManager.getInstance().canPerformAction(ChatActionType.call, this.dialogId);\n\n\t\t\treturn chatCanBeCalled && chatIsAllowedToCall;\n\t\t},\n\t\tisConference(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.videoconf;\n\t\t},\n\t\tcallButtonText(): string\n\t\t{\n\t\t\tconst locCode = CallTypes[this.lastCallType].locCode;\n\n\t\t\treturn this.loc(locCode);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.lastCallType = this.getLastCallChoice();\n\t\tthis.subscribeToMenuItemClick();\n\t},\n\tmethods:\n\t{\n\t\tstartVideoCall()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMessenger.startVideoCall(this.dialogId);\n\t\t},\n\t\tsubscribeToMenuItemClick()\n\t\t{\n\t\t\tthis.getCallMenu().subscribe(\n\t\t\t\tCallMenu.events.onMenuItemClick,\n\t\t\t\t(event: BaseEvent<{id: string}>) => {\n\t\t\t\t\tconst { id: callTypeId } = event.getData();\n\t\t\t\t\tthis.saveLastCallChoice(callTypeId);\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tgetCallMenu(): CallMenu\n\t\t{\n\t\t\tif (!this.callMenu)\n\t\t\t{\n\t\t\t\tthis.callMenu = new CallMenu();\n\t\t\t}\n\n\t\t\treturn this.callMenu;\n\t\t},\n\t\tonButtonClick()\n\t\t{\n\t\t\tif (!this.isActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tCallTypes[this.lastCallType].start(this.dialogId);\n\t\t},\n\t\tonMenuClick()\n\t\t{\n\t\t\tif (!this.shouldShowMenu())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.getCallMenu().openMenu(this.dialog, this.$refs.menu);\n\t\t},\n\t\tonStartConferenceClick()\n\t\t{\n\t\t\tMessenger.openConference({ code: this.dialog.public.code });\n\t\t},\n\t\tgetLastCallChoice(): string\n\t\t{\n\t\t\tconst result = LocalStorageManager.getInstance().get(LocalStorageKey.lastCallType, CallTypes.video.id);\n\t\t\tif (result === CallTypes.beta.id && !this.isBitrixCallEnabled())\n\t\t\t{\n\t\t\t\treturn CallTypes.video.id;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tsaveLastCallChoice(callTypeId: string)\n\t\t{\n\t\t\tthis.lastCallType = callTypeId;\n\t\t\tLocalStorageManager.getInstance().set(LocalStorageKey.lastCallType, callTypeId);\n\t\t},\n\t\tshouldShowMenu(): boolean\n\t\t{\n\t\t\treturn this.isActive || this.isBitrixCallEnabled();\n\t\t},\n\t\tisBitrixCallEnabled(): boolean\n\t\t{\n\t\t\t// TODO remove this after release call beta\n\t\t\t// const settings = Extension.getSettings('im.v2.component.content.chat');\n\t\t\t// return settings.get('isBitrixCallEnabled');\n\n\t\t\treturn false;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isConference\" class=\"bx-im-chat-header-call-button__scope bx-im-chat-header-call-button__container --conference\" @click=\"onStartConferenceClick\">\n\t\t\t<div class=\"bx-im-chat-header-call-button__text\">\n\t\t\t\t{{ loc('IM_CONTENT_CHAT_HEADER_START_CONFERENCE') }}\n\t\t\t</div>\n\t\t</div>\n\t\t<div\n\t\t\tv-else\n\t\t\tclass=\"bx-im-chat-header-call-button__scope bx-im-chat-header-call-button__container\"\n\t\t\t:class=\"{'--disabled': !isActive}\"\n\t\t\t@click=\"onButtonClick\"\n\t\t>\n\t\t\t<div class=\"bx-im-chat-header-call-button__text\">\n\t\t\t\t{{ callButtonText }}\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-chat-header-call-button__separator\"></div>\n\t\t\t<div class=\"bx-im-chat-header-call-button__chevron_container\" @click.stop=\"onMenuClick\">\n\t\t\t\t<div class=\"bx-im-chat-header-call-button__chevron\" ref=\"menu\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { ChatType, ChatEntityLinkType } from 'im.v2.const';\nimport { Loc } from 'main.core';\n\ntype ChatTypeParams = {\n\t[chatType: $Values<typeof ChatType>]: {\n\t\tclassName: string,\n\t\tloc: string,\n\t}\n};\n\nexport const ParamsByLinkType: ChatTypeParams = {\n\t[ChatEntityLinkType.tasks]: {\n\t\tclassName: '--task',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_TASK'),\n\t},\n\t[ChatEntityLinkType.calendar]: {\n\t\tclassName: '--calendar',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_MEETING_MSGVER_1'),\n\t},\n\t[ChatEntityLinkType.sonetGroup]: {\n\t\tclassName: '--group',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_GROUP_MSGVER_1'),\n\t},\n\t[ChatEntityLinkType.mail]: {\n\t\tclassName: '--mail',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_MAIL_MSGVER_1'),\n\t},\n\t[ChatEntityLinkType.contact]: {\n\t\tclassName: '--crm',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_CONTACT'),\n\t},\n\t[ChatEntityLinkType.deal]: {\n\t\tclassName: '--crm',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_DEAL'),\n\t},\n\t[ChatEntityLinkType.lead]: {\n\t\tclassName: '--crm',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_LEAD'),\n\t},\n\t[ChatEntityLinkType.dynamic]: {\n\t\tclassName: '--crm',\n\t\tloc: Loc.getMessage('IM_CONTENT_CHAT_HEADER_OPEN_DYNAMIC_ELEMENT'),\n\t},\n};\n","import { ParamsByLinkType } from './const/chat-type-params';\n\nimport './css/entity-link.css';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const EntityLink = {\n\tname: 'EntityLink',\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tentityType(): string\n\t\t{\n\t\t\treturn this.dialog.entityLink.type;\n\t\t},\n\t\tentityUrl(): string\n\t\t{\n\t\t\treturn this.dialog.entityLink.url;\n\t\t},\n\t\tcontainerClassName(): string\n\t\t{\n\t\t\treturn ParamsByLinkType[this.entityType]?.className ?? '';\n\t\t},\n\t\tlinkText(): string\n\t\t{\n\t\t\treturn ParamsByLinkType[this.entityType]?.loc ?? 'Open entity';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a :href=\"entityUrl\" class=\"bx-im-chat-header-entity-link__container\" :class=\"containerClassName\" target=\"_blank\">\n\t\t\t<div class=\"bx-im-chat-header-entity-link__icon\"></div>\n\t\t\t<div class=\"bx-im-chat-header-entity-link__text\">{{ linkText }}</div>\n\t\t\t<div class=\"bx-im-chat-header-entity-link__arrow\"></div>\n\t\t</a>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport { ChatType } from 'im.v2.const';\nimport { EditableChatTitle, LineLoader } from 'im.v2.component.elements';\nimport { FadeAnimation } from 'im.v2.component.animation';\n\nimport { EntityLink } from '../entity-link/entity-link';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\n\nconst UserCounterPhraseCodeByChatType = {\n\t[ChatType.openChannel]: 'IM_CONTENT_CHAT_HEADER_CHANNEL_USER_COUNT',\n\t[ChatType.channel]: 'IM_CONTENT_CHAT_HEADER_CHANNEL_USER_COUNT',\n\tdefault: 'IM_CONTENT_CHAT_HEADER_USER_COUNT',\n};\n\n// @vue/component\nexport const GroupChatTitle = {\n\tname: 'GroupChatTitle',\n\tcomponents: { EditableChatTitle, EntityLink, LineLoader, FadeAnimation },\n\tprops:\n\t\t{\n\t\t\tdialogId: {\n\t\t\t\ttype: String,\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t},\n\temits: ['membersClick', 'newTitle'],\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t\t{\n\t\t\tdialog(): ImModelChat\n\t\t\t{\n\t\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t\t},\n\t\t\thasEntityLink(): boolean\n\t\t\t{\n\t\t\t\treturn Boolean(this.dialog.entityLink?.url);\n\t\t\t},\n\t\t\tuserCounterPhraseCode(): string\n\t\t\t{\n\t\t\t\treturn UserCounterPhraseCodeByChatType[this.dialog.type] ?? UserCounterPhraseCodeByChatType.default;\n\t\t\t},\n\t\t\tuserCounterText(): string\n\t\t\t{\n\t\t\t\treturn Loc.getMessagePlural(this.userCounterPhraseCode, this.dialog.userCounter, {\n\t\t\t\t\t'#COUNT#': this.dialog.userCounter,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\tmethods:\n\t\t{\n\t\t\tloc(phraseCode: string): string\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t\t},\n\t\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-chat-header__info\">\n\t\t\t<EditableChatTitle :dialogId=\"dialogId\" @newTitleSubmit=\"$emit('newTitle', $event)\" />\n\t\t\t<LineLoader v-if=\"!dialog.inited\" :width=\"50\" :height=\"16\" />\n\t\t\t<FadeAnimation :duration=\"100\">\n\t\t\t\t<div v-if=\"dialog.inited\" class=\"bx-im-chat-header__subtitle_container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\t:title=\"loc('IM_CONTENT_CHAT_HEADER_OPEN_MEMBERS')\"\n\t\t\t\t\t\t@click=\"$emit('membersClick')\"\n\t\t\t\t\t\tclass=\"bx-im-chat-header__subtitle_content --click\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ userCounterText }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<EntityLink v-if=\"hasEntityLink\" :dialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t</FadeAnimation>\n\t\t</div>\n\t`,\n};\n","import { Utils } from 'im.v2.lib.utils';\nimport { ChatTitle } from 'im.v2.component.elements';\n\nimport type { JsonObject } from 'main.core';\n\nconst ONE_MINUTE = 60 * 1000;\n\n// @vue/component\nexport const UserTitle = {\n\tname: 'UserTitle',\n\tcomponents: { ChatTitle },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tuserLastOnlineText: '',\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tuserPosition(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getPosition'](this.dialogId);\n\t\t},\n\t\tuserLastOnline(): string\n\t\t{\n\t\t\treturn this.$store.getters['users/getLastOnline'](this.dialogId);\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tuserLastOnline(value)\n\t\t{\n\t\t\tthis.userLastOnlineText = value;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.updateUserOnline();\n\t\tthis.userLastOnlineInterval = setInterval(this.updateUserOnline, ONE_MINUTE);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tclearInterval(this.userLastOnlineInterval);\n\t},\n\tmethods:\n\t{\n\t\tupdateUserOnline(): void\n\t\t{\n\t\t\tthis.userLastOnlineText = this.$store.getters['users/getLastOnline'](this.dialogId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-chat-header__info\">\n\t\t\t<div class=\"bx-im-chat-header__title --user\">\n\t\t\t\t<a :href=\"userLink\" target=\"_blank\" class=\"bx-im-chat-header__title_container\">\n\t\t\t\t\t<ChatTitle :dialogId=\"dialogId\" />\n\t\t\t\t</a>\n\t\t\t\t<span class=\"bx-im-chat-header__user-status\">{{ userLastOnlineText }}</span>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-chat-header__subtitle_container\">\n\t\t\t\t<div class=\"bx-im-chat-header__subtitle_content\">{{ userPosition }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { ChatTitle, EditableChatTitle } from 'im.v2.component.elements';\n\n// @vue/component\nexport const MultidialogChatTitle = {\n\tname: 'MultidialogChatTitle',\n\tcomponents: { EditableChatTitle, ChatTitle },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['newTitle'],\n\tcomputed:\n\t{\n\t\tisSupportBot(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['users/bots/isSupport'](this.dialogId);\n\t\t},\n\t\tsubtitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_CONTENT_CHAT_HEADER_SUPPORT_SUBTITLE');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-chat-header__info\">\n\t\t\t<ChatTitle v-if=\"isSupportBot\" :dialogId=\"dialogId\" />\n\t\t\t<EditableChatTitle v-else :dialogId=\"dialogId\" @newTitleSubmit=\"$emit('newTitle', $event)\" />\n\t\t\t<div class=\"bx-im-chat-header__subtitle_container\">\n\t\t\t\t<div class=\"bx-im-chat-header__subtitle_content\">{{ subtitle }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport 'ui.notification';\n\nimport { Avatar, AvatarSize, LineLoader } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\nimport { ChatType, ChatActionType, EventType, SidebarDetailBlock } from 'im.v2.const';\nimport { AddToChat } from 'im.v2.component.entity-selector';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { FadeAnimation } from 'im.v2.component.animation';\n\nimport { CallButton } from './components/call-button/call-button';\nimport { GroupChatTitle } from './components/title/group-chat';\nimport { UserTitle as UserChatTitle } from './components/title/user';\nimport { MultidialogChatTitle } from './components/title/multidialog';\n\nimport './css/chat-header.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelUser, ImModelChat } from 'im.v2.model';\n\nexport const ChatTitle = Object.freeze({\n\tgroup: 'group',\n\tuser: 'user',\n\tmultidialog: 'multidialog',\n});\n\n// @vue/component\nexport const ChatHeader = {\n\tname: 'ChatHeader',\n\tcomponents: {\n\t\tAvatar,\n\t\tAddToChat,\n\t\tCallButton,\n\t\tGroupChatTitle,\n\t\tUserChatTitle,\n\t\tMultidialogChatTitle,\n\t\tLineLoader,\n\t\tFadeAnimation,\n\t},\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcurrentSidebarPanel: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['toggleRightPanel', 'toggleSearchPanel', 'toggleMembersPanel'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tshowAddToChatPopup: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.dialogId, true);\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisBot(): boolean\n\t\t{\n\t\t\tif (!this.isUser)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.user.bot === true;\n\t\t},\n\t\tisChat(): boolean\n\t\t{\n\t\t\treturn !this.isUser;\n\t\t},\n\t\tchatId(): number\n\t\t{\n\t\t\treturn this.dialog.chatId;\n\t\t},\n\t\tuserLink(): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(this.dialogId);\n\t\t},\n\t\tshowCallButton(): boolean\n\t\t{\n\t\t\tif (this.isBot || this.isSupport)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.call, this.dialogId);\n\t\t},\n\t\tshowInviteButton(): boolean\n\t\t{\n\t\t\tif (this.isBot)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.extend, this.dialogId);\n\t\t},\n\t\tshowSidebarButton(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.openSidebar, this.dialogId);\n\t\t},\n\t\tcanChangeAvatar(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.avatar, this.dialogId);\n\t\t},\n\t\tisSidebarOpened(): boolean\n\t\t{\n\t\t\treturn this.currentSidebarPanel.length > 0;\n\t\t},\n\t\tisMessageSearchActive(): boolean\n\t\t{\n\t\t\treturn this.currentSidebarPanel === SidebarDetailBlock.messageSearch;\n\t\t},\n\t\theaderTitleComponentName(): string\n\t\t{\n\t\t\treturn `${this.chatTitle}ChatTitle`;\n\t\t},\n\t\tisSupport(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['sidebar/multidialog/isSupport'](this.dialogId);\n\t\t},\n\t\tchatTitle(): string\n\t\t{\n\t\t\tif (this.isSupport)\n\t\t\t{\n\t\t\t\treturn ChatTitle.multidialog;\n\t\t\t}\n\n\t\t\tif (this.isUser)\n\t\t\t{\n\t\t\t\treturn ChatTitle.user;\n\t\t\t}\n\n\t\t\treturn ChatTitle.group;\n\t\t},\n\t\thasUserLink(): boolean\n\t\t{\n\t\t\treturn this.isUser && !this.isSupport;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\ttoggleRightPanel()\n\t\t{\n\t\t\tif (this.currentSidebarPanel)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.sidebar.close, { panel: '' });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.main,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\ttoggleSearchPanel()\n\t\t{\n\t\t\tif (this.isMessageSearchActive)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.sidebar.close, { panel: SidebarDetailBlock.messageSearch });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.messageSearch,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonMembersClick()\n\t\t{\n\t\t\tif (!this.isInited)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.currentSidebarPanel === SidebarDetailBlock.members)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.sidebar.close, { panel: SidebarDetailBlock.members });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\tpanel: SidebarDetailBlock.members,\n\t\t\t\tdialogId: this.dialogId,\n\t\t\t});\n\t\t},\n\t\tonNewTitleSubmit(newTitle: string)\n\t\t{\n\t\t\tthis.getChatService().renameChat(this.dialogId, newTitle).catch(() => {\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('IM_CONTENT_CHAT_HEADER_RENAME_ERROR'),\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\topenInvitePopup()\n\t\t{\n\t\t\tthis.showAddToChatPopup = true;\n\t\t},\n\t\tonAvatarClick()\n\t\t{\n\t\t\tif (!this.isChat || !this.canChangeAvatar)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$refs.avatarInput.click();\n\t\t},\n\t\tasync onAvatarSelect(event: Event)\n\t\t{\n\t\t\tconst input: HTMLInputElement = event.target;\n\t\t\tconst file: File = input.files[0];\n\t\t\tif (!file)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst preparedAvatar = await this.getChatService().prepareAvatar(file);\n\t\t\tif (!preparedAvatar)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvoid this.getChatService().changeAvatar(this.dialog.chatId, preparedAvatar);\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-chat-header__scope bx-im-chat-header__container\">\n\t\t\t<div class=\"bx-im-chat-header__left\">\n\t\t\t\t<slot name=\"left\">\n\t\t\t\t\t<div class=\"bx-im-chat-header__avatar\" :class=\"{'--can-change': canChangeAvatar}\" @click=\"onAvatarClick\">\n\t\t\t\t\t\t<a v-if=\"hasUserLink\" :href=\"userLink\" target=\"_blank\">\n\t\t\t\t\t\t\t<Avatar :dialogId=\"dialogId\" :size=\"AvatarSize.L\" />\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<Avatar v-else :dialogId=\"dialogId\" :size=\"AvatarSize.L\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<input \n\t\t\t\t\t\ttype=\"file\" \n\t\t\t\t\t\t@change=\"onAvatarSelect\" \n\t\t\t\t\t\taccept=\"image/*\" \n\t\t\t\t\t\tclass=\"bx-im-chat-header__avatar_input\" \n\t\t\t\t\t\tref=\"avatarInput\"\n\t\t\t\t\t>\n\t\t\t\t\t<component\n\t\t\t\t\t\t:is=\"headerTitleComponentName\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t@membersClick=\"onMembersClick\"\n\t\t\t\t\t\t@newTitle=\"onNewTitleSubmit\"\n\t\t\t\t\t/>\n\t\t\t\t</slot>\n\t\t\t</div>\n\t\t\t<LineLoader v-if=\"!isInited\" :width=\"45\" :height=\"22\" />\n\t\t\t<FadeAnimation :duration=\"100\">\n\t\t\t\t<div v-if=\"isInited\" class=\"bx-im-chat-header__right\">\n\t\t\t\t\t<slot name=\"before-actions\"></slot>\n\t\t\t\t\t<CallButton v-if=\"showCallButton\" :dialogId=\"dialogId\" />\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"showInviteButton\"\n\t\t\t\t\t\t:title=\"loc('IM_CONTENT_CHAT_HEADER_OPEN_INVITE_POPUP_TITLE')\"\n\t\t\t\t\t\t:class=\"{'--active': showAddToChatPopup}\"\n\t\t\t\t\t\tclass=\"bx-im-chat-header__icon --add-people\"\n\t\t\t\t\t\t@click=\"openInvitePopup\" \n\t\t\t\t\t\tref=\"add-members\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div \n\t\t\t\t\t\t:title=\"loc('IM_CONTENT_CHAT_HEADER_OPEN_SEARCH')\"\n\t\t\t\t\t\t:class=\"{'--active': isMessageSearchActive}\"\n\t\t\t\t\t\tclass=\"bx-im-chat-header__icon --search\" \n\t\t\t\t\t\t@click=\"toggleSearchPanel\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"showSidebarButton\"\n\t\t\t\t\t\tclass=\"bx-im-chat-header__icon --panel\"\n\t\t\t\t\t\t:title=\"loc('IM_CONTENT_CHAT_HEADER_OPEN_SIDEBAR')\"\n\t\t\t\t\t\t:class=\"{'--active': isSidebarOpened}\"\n\t\t\t\t\t\t@click=\"toggleRightPanel\" \n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</FadeAnimation>\n\t\t\t<AddToChat\n\t\t\t\t:bindElement=\"$refs['add-members'] || {}\"\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t:showPopup=\"showAddToChatPopup\"\n\t\t\t\t:popupConfig=\"{offsetTop: 15, offsetLeft: -300}\"\n\t\t\t\t@close=\"showAddToChatPopup = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Event, Type, type JsonObject } from 'main.core';\nimport { getFilesFromDataTransfer, hasDataTransferOnlyFiles } from 'ui.uploader.core';\n\nimport { UploadingService } from 'im.v2.provider.service';\n\nimport { Height } from '../const/size';\n\nimport type { ImModelChat } from 'im.v2.model';\n\nimport '../css/drop-area.css';\n\n// @vue/component\nexport const DropArea = {\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcontainer: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tshowDropArea: false,\n\t\t\tlastDropAreaEnterTarget: null,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\thasPinnedMessages(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['messages/pin/getPinned'](this.dialog.chatId).length > 0;\n\t\t},\n\t\tdropAreaStyles(): {[top: string]: string}\n\t\t{\n\t\t\tlet offset = Height.dropAreaOffset + Height.chatHeader;\n\t\t\tif (this.hasPinnedMessages)\n\t\t\t{\n\t\t\t\toffset += Height.pinnedMessages;\n\t\t\t}\n\n\t\t\treturn { top: `${offset}px` };\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tcontainer: {\n\t\t\timmediate: true,\n\t\t\thandler(newValue)\n\t\t\t{\n\t\t\t\tif (!Type.isElementNode(newValue))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.bindEvents();\n\t\t\t},\n\t\t},\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.unbindEvents();\n\t},\n\tmethods:\n\t{\n\t\tbindEvents()\n\t\t{\n\t\t\tEvent.bind(this.container, 'dragenter', this.onDragEnter);\n\t\t\tEvent.bind(this.container, 'dragleave', this.onDragLeave);\n\t\t\tEvent.bind(this.container, 'dragover', this.onDragOver);\n\t\t\tEvent.bind(this.container, 'drop', this.onDrop);\n\t\t},\n\t\tunbindEvents()\n\t\t{\n\t\t\tEvent.unbind(this.container, 'dragenter', this.onDragEnter);\n\t\t\tEvent.unbind(this.container, 'dragleave', this.onDragLeave);\n\t\t\tEvent.unbind(this.container, 'dragover', this.onDragOver);\n\t\t\tEvent.unbind(this.container, 'drop', this.onDrop);\n\t\t},\n\t\tasync onDragEnter(event: DragEvent)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\tconst success = await hasDataTransferOnlyFiles(event.dataTransfer, false);\n\t\t\tif (!success)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.lastDropAreaEnterTarget = event.target;\n\t\t\tthis.showDropArea = true;\n\t\t},\n\t\tonDragLeave(event: DragEvent)\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t\tevent.preventDefault();\n\n\t\t\tif (this.lastDropAreaEnterTarget !== event.target)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showDropArea = false;\n\t\t},\n\t\tonDragOver(event: DragEvent)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t},\n\t\tasync onDrop(event: DragEvent)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tconst files = await getFilesFromDataTransfer(event.dataTransfer);\n\t\t\tthis.getUploadingService().addFilesFromInput(files, this.dialogId);\n\t\t\tthis.showDropArea = false;\n\t\t},\n\t\tgetUploadingService(): UploadingService\n\t\t{\n\t\t\tif (!this.uploadingService)\n\t\t\t{\n\t\t\t\tthis.uploadingService = UploadingService.getInstance();\n\t\t\t}\n\n\t\t\treturn this.uploadingService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Transition name=\"drop-area-fade\">\n\t\t\t<div v-if=\"showDropArea\" :style=\"dropAreaStyles\" class=\"bx-im-content-chat-drop-area__container bx-im-content-chat-drop-area__scope\">\n\t\t\t\t<div class=\"bx-im-content-chat-drop-area__box\">\n\t\t\t\t\t<span class=\"bx-im-content-chat-drop-area__icon\"></span>\n\t\t\t\t\t<label class=\"bx-im-content-chat-drop-area__label-text\">\n\t\t\t\t\t\t{{ loc('IM_CONTENT_DROP_AREA') }}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Transition>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { Button as ChatButton, ButtonSize } from 'im.v2.component.elements';\nimport { Color } from 'im.v2.const';\nimport { ChatService } from 'im.v2.provider.service';\n\nimport type { CustomColorScheme } from 'im.v2.component.elements';\nimport type { ImModelChat } from 'im.v2.model';\n\nconst BUTTON_BACKGROUND_COLOR = 'rgba(0, 0, 0, 0.1)';\nconst BUTTON_HOVER_COLOR = 'rgba(0, 0, 0, 0.2)';\nconst BUTTON_TEXT_COLOR = '#fff';\n\n// @vue/component\nexport const MutePanel = {\n\tcomponents: { ChatButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisMuted(): boolean\n\t\t{\n\t\t\treturn this.dialog.muteList.includes(Core.getUserId());\n\t\t},\n\t\tbuttonText(): string\n\t\t{\n\t\t\tconst mutedCode = this.loc('IM_CONTENT_BLOCKED_TEXTAREA_ENABLE_NOTIFICATIONS');\n\t\t\tconst unmutedCode = this.loc('IM_CONTENT_BLOCKED_TEXTAREA_DISABLE_NOTIFICATIONS');\n\n\t\t\treturn this.isMuted ? mutedCode : unmutedCode;\n\t\t},\n\t\tbuttonColorScheme(): CustomColorScheme\n\t\t{\n\t\t\treturn {\n\t\t\t\tborderColor: Color.transparent,\n\t\t\t\tbackgroundColor: BUTTON_BACKGROUND_COLOR,\n\t\t\t\ticonColor: BUTTON_TEXT_COLOR,\n\t\t\t\ttextColor: BUTTON_TEXT_COLOR,\n\t\t\t\thoverColor: BUTTON_HOVER_COLOR,\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonButtonClick()\n\t\t{\n\t\t\tif (this.isMuted)\n\t\t\t{\n\t\t\t\tthis.getChatService().unmuteChat(this.dialogId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getChatService().muteChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__textarea_placeholder\">\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t:customColorScheme=\"buttonColorScheme\"\n\t\t\t\t:text=\"buttonText\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Button as ChatButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\n\n// @vue/component\nexport const JoinPanel = {\n\tcomponents: { ChatButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t},\n\tmethods:\n\t{\n\t\tonButtonClick()\n\t\t{\n\t\t\tthis.getChatService().joinChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__textarea_placeholder\">\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t:text=\"loc('IM_CONTENT_BLOCKED_TEXTAREA_JOIN_CHAT')\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import '../css/loading-bar.css';\n\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const LoadingBar = {\n\tname: 'LoadingBar',\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__loading-bar\"></div>\n\t`,\n};\n","export const TextareaObserverDirective = {\n\tmounted(element, binding)\n\t{\n\t\tbinding.instance.textareaResizeManager.observeTextarea(element);\n\t},\n\tbeforeUnmount(element, binding)\n\t{\n\t\tbinding.instance.textareaResizeManager.unobserveTextarea(element);\n\t},\n};\n","import { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport { ChatDialog } from 'im.v2.component.dialog.chat';\nimport { ChatTextarea } from 'im.v2.component.textarea';\nimport { ThemeManager } from 'im.v2.lib.theme';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ResizeManager } from 'im.v2.lib.textarea';\nimport { ChatSidebar } from 'im.v2.component.sidebar';\nimport { ChatActionType, Settings, UserRole, SidebarDetailBlock, EventType } from 'im.v2.const';\n\nimport { Height } from './const/size';\nimport { ChatHeader } from './components/chat-header/chat-header';\nimport { DropArea } from './components/drop-area';\nimport { MutePanel } from './components/mute-panel';\nimport { JoinPanel } from './components/join-panel';\nimport { LoadingBar } from './components/loading-bar';\nimport { TextareaObserverDirective } from './utils/observer-directive';\n\nimport './css/base-chat-content.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\nimport type { BackgroundStyle } from 'im.v2.lib.theme';\n\n// @vue/component\nexport const BaseChatContent = {\n\tname: 'BaseChatContent',\n\tcomponents:\n\t{\n\t\tChatHeader,\n\t\tChatDialog,\n\t\tChatTextarea,\n\t\tChatSidebar,\n\t\tDropArea,\n\t\tMutePanel,\n\t\tJoinPanel,\n\t\tLoadingBar,\n\t},\n\tdirectives: { 'textarea-observer': TextareaObserverDirective },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcommentsOpened: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tcurrentSidebarPanel: '',\n\t\t\ttextareaHeight: 0,\n\t\t\tshowLoadingBar: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tcanSend(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.send, this.dialog.dialogId);\n\t\t},\n\t\tisGuest(): boolean\n\t\t{\n\t\t\treturn this.dialog.role === UserRole.guest;\n\t\t},\n\t\tcontainerClasses(): string[]\n\t\t{\n\t\t\tconst alignment = this.$store.getters['application/settings/get'](Settings.appearance.alignment);\n\n\t\t\treturn [`--${alignment}-align`];\n\t\t},\n\t\tbackgroundStyle(): BackgroundStyle\n\t\t{\n\t\t\treturn ThemeManager.getCurrentBackgroundStyle();\n\t\t},\n\t\tdialogContainerStyle(): Object\n\t\t{\n\t\t\tlet textareaHeight = this.textareaHeight;\n\t\t\tif (!this.canSend)\n\t\t\t{\n\t\t\t\ttextareaHeight = Height.blockedTextarea;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\theight: `calc(100% - ${Height.chatHeader}px - ${textareaHeight}px)`,\n\t\t\t};\n\t\t},\n\t},\n\twatch:\n\t{\n\t\ttextareaHeight(newValue, oldValue)\n\t\t{\n\t\t\tif (!this.dialog.inited || oldValue === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {\n\t\t\t\tchatId: this.dialog.chatId,\n\t\t\t\tanimation: false,\n\t\t\t});\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.initTextareaResizeManager();\n\t\tthis.bindEvents();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.unbindEvents();\n\t},\n\tmethods:\n\t{\n\t\tinitTextareaResizeManager()\n\t\t{\n\t\t\tthis.textareaResizeManager = new ResizeManager();\n\t\t\tthis.textareaResizeManager.subscribe(ResizeManager.events.onHeightChange, this.onTextareaHeightChange);\n\t\t},\n\t\tonTextareaMount()\n\t\t{\n\t\t\tconst textareaContainer: HTMLDivElement = this.$refs['textarea-container'];\n\t\t\tthis.textareaHeight = textareaContainer.clientHeight;\n\t\t},\n\t\tonTextareaHeightChange(event: BaseEvent<{newHeight: number}>)\n\t\t{\n\t\t\tconst { newHeight } = event.getData();\n\t\t\tthis.textareaHeight = newHeight;\n\t\t},\n\t\tonChangeSidebarPanel({ panel }: {panel: $Keys<typeof SidebarDetailBlock>})\n\t\t{\n\t\t\tthis.currentSidebarPanel = panel;\n\t\t},\n\t\tonShowLoadingBar(event: BaseEvent<{ dialogId: string }>)\n\t\t{\n\t\t\tconst { dialogId } = event.getData();\n\t\t\tif (dialogId !== this.dialogId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.showLoadingBar = true;\n\t\t},\n\t\tonHideLoadingBar(event: BaseEvent<{ dialogId: string }>)\n\t\t{\n\t\t\tconst { dialogId } = event.getData();\n\t\t\tif (dialogId !== this.dialogId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.showLoadingBar = false;\n\t\t},\n\t\tbindEvents()\n\t\t{\n\t\t\tEventEmitter.subscribe(EventType.dialog.showLoadingBar, this.onShowLoadingBar);\n\t\t\tEventEmitter.subscribe(EventType.dialog.hideLoadingBar, this.onHideLoadingBar);\n\t\t},\n\t\tunbindEvents()\n\t\t{\n\t\t\tEventEmitter.unsubscribe(EventType.dialog.showLoadingBar, this.onShowLoadingBar);\n\t\t\tEventEmitter.unsubscribe(EventType.dialog.hideLoadingBar, this.onHideLoadingBar);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__scope bx-im-content-chat__container\" :class=\"containerClasses\" :style=\"backgroundStyle\">\n\t\t\t<div class=\"bx-im-content-chat__content\" ref=\"content\">\n\t\t\t\t<slot name=\"header\" :currentSidebarPanel=\"currentSidebarPanel\">\n\t\t\t\t\t<ChatHeader :dialogId=\"dialogId\" :key=\"dialogId\" :currentSidebarPanel=\"currentSidebarPanel\"/>\n\t\t\t\t</slot>\n\t\t\t\t<div :style=\"dialogContainerStyle\" class=\"bx-im-content-chat__dialog_container\">\n\t\t\t\t\t<Transition name=\"loading-bar-transition\">\n\t\t\t\t\t\t<LoadingBar v-if=\"showLoadingBar\" />\n\t\t\t\t\t</Transition>\n\t\t\t\t\t<div class=\"bx-im-content-chat__dialog_content\">\n\t\t\t\t\t\t<slot name=\"dialog\">\n\t\t\t\t\t\t\t<ChatDialog :dialogId=\"dialogId\" :key=\"dialogId\" />\n\t\t\t\t\t\t</slot>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<!-- Textarea -->\n\t\t\t\t<div v-if=\"canSend\" v-textarea-observer class=\"bx-im-content-chat__textarea_container\" ref=\"textarea-container\">\n\t\t\t\t\t<slot name=\"textarea\" :onTextareaMount=\"onTextareaMount\">\n\t\t\t\t\t\t<ChatTextarea :dialogId=\"dialogId\" :key=\"dialogId\" @mounted=\"onTextareaMount\" />\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t\t<slot v-else-if=\"isGuest\" name=\"join-panel\">\n\t\t\t\t\t<JoinPanel :dialogId=\"dialogId\" />\n\t\t\t\t</slot>\n\t\t\t\t<MutePanel v-else :dialogId=\"dialogId\" />\n\t\t\t\t<!-- End textarea -->\n\t\t\t\t<DropArea :dialogId=\"dialogId\" :container=\"$refs.content || {}\" :key=\"dialogId\" />\n\t\t\t</div>\n\t\t\t<ChatSidebar \n\t\t\t\tv-if=\"dialogId.length > 0\" \n\t\t\t\t:originDialogId=\"dialogId\"\n\t\t\t\t:isActive=\"!commentsOpened\"\n\t\t\t\t@changePanel=\"onChangeSidebarPanel\" \n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import '../css/comments-button.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const CommentsButton = {\n\tname: 'CommentsButton',\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcounter: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-dialog-channel__comments-button\">\n\t\t\t<div class=\"bx-im-dialog-channel__comments-button_counter\">\n\t\t\t\t{{ counter }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { MessageMenu } from 'im.v2.component.message-list';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\n\nexport class ChannelMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\t// this.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getCopyLinkItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getPinItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getDelimiter(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getDelimiter(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDisk(),\n\t\t\tthis.getDelimiter(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n}\n","import { MessageList } from 'im.v2.component.message-list';\n\nimport { ChannelMessageMenu } from '../classes/message-menu';\n\n// @vue/component\nexport const ChannelMessageList = {\n\tname: 'ChannelMessageList',\n\tcomponents: { MessageList },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tChannelMessageMenu: () => ChannelMessageMenu,\n\t},\n\ttemplate: `\n\t\t<MessageList :dialogId=\"dialogId\" :messageMenuClass=\"ChannelMessageMenu\" />\n\t`,\n};\n","import { ChatDialog } from 'im.v2.component.dialog.chat';\nimport { Layout, UserRole } from 'im.v2.const';\n\nimport { CommentsButton } from './comments-button';\n\nimport { ChannelMessageList } from './message-list';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelLayout } from 'im.v2.model';\n\ntype CommentCounterItem = { [commentChatId: string]: number };\n\n// @vue/component\nexport const ChannelDialog = {\n\tname: 'ChannelDialog',\n\tcomponents: { ChatDialog, ChannelMessageList, CommentsButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tlocalCommentsCounterMap: {},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tisGuest(): boolean\n\t\t{\n\t\t\treturn this.dialog.role === UserRole.guest;\n\t\t},\n\t\tisChatLayout(): boolean\n\t\t{\n\t\t\treturn this.layout.name === Layout.chat.name;\n\t\t},\n\t\trealCommentsWithCounter(): number[]\n\t\t{\n\t\t\treturn this.$store.getters['counters/getCommentsWithCounter'](this.dialog.chatId);\n\t\t},\n\t\trealCommentsCounterMap(): CommentCounterItem\n\t\t{\n\t\t\tconst map = {};\n\t\t\tthis.realCommentsWithCounter.forEach((commentChatId) => {\n\t\t\t\tmap[commentChatId] = this.$store.getters['counters/getSpecificCommentsCounter']({\n\t\t\t\t\tchannelId: this.dialog.chatId,\n\t\t\t\t\tcommentChatId,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn map;\n\t\t},\n\t\tlocalCommentsQueue(): number[]\n\t\t{\n\t\t\treturn Object.keys(this.localCommentsCounterMap).map((key) => Number(key));\n\t\t},\n\t\tlocalTotalCommentsCounter(): number\n\t\t{\n\t\t\tlet counter = 0;\n\t\t\tObject.values(this.localCommentsCounterMap).forEach((singleCounter) => {\n\t\t\t\tcounter += singleCounter;\n\t\t\t});\n\n\t\t\treturn counter;\n\t\t},\n\t\tshowCommentsButton(): boolean\n\t\t{\n\t\t\treturn this.isChatLayout && this.localCommentsQueue.length > 0;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\trealCommentsWithCounter(newList: number[], oldList: number[]) {\n\t\t\tconst addedChatIds = this.getAddedElements(newList, oldList);\n\t\t\taddedChatIds.forEach((addedChatId) => {\n\t\t\t\tthis.localCommentsCounterMap[addedChatId] = this.realCommentsCounterMap[addedChatId];\n\t\t\t});\n\n\t\t\tconst removedChatIds = this.getRemovedElements(newList, oldList);\n\t\t\tremovedChatIds.forEach((removedChatId) => {\n\t\t\t\tdelete this.localCommentsCounterMap[removedChatId];\n\t\t\t});\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.localCommentsCounterMap = { ...this.realCommentsCounterMap };\n\t},\n\tmethods:\n\t{\n\t\tasync onCommentsButtonClick()\n\t\t{\n\t\t\tconst [chatIdToJump] = this.localCommentsQueue;\n\t\t\tconst messageIdToJump: ?number = this.$store.getters['messages/comments/getMessageIdByChatId'](chatIdToJump);\n\n\t\t\tif (messageIdToJump)\n\t\t\t{\n\t\t\t\tthis.$refs.dialog.goToMessageContext(messageIdToJump);\n\t\t\t\tdelete this.localCommentsCounterMap[chatIdToJump];\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.goToMessageContextByCommentsChatId(chatIdToJump);\n\t\t\tdelete this.localCommentsCounterMap[chatIdToJump];\n\t\t},\n\t\tasync goToMessageContextByCommentsChatId(chatId: string)\n\t\t{\n\t\t\tthis.$refs.dialog.showLoadingBar();\n\t\t\tconst messageId = await this.$refs.dialog.getMessageService().loadContextByChatId(chatId)\n\t\t\t\t.catch((error) => {\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.error('ChannelDialog: goToMessageContextByCommentsChatId error', error);\n\t\t\t\t});\n\t\t\tthis.$refs.dialog.hideLoadingBar();\n\n\t\t\tif (!messageId)\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.error('ChannelDialog: no messageId after loading context');\n\t\t\t}\n\n\t\t\tawait this.$nextTick();\n\t\t\tthis.$refs.dialog.getScrollManager().scrollToMessage(messageId);\n\t\t\tawait this.$nextTick();\n\t\t\tthis.$refs.dialog.highlightMessage(messageId);\n\t\t},\n\t\tgetAddedElements(newList: number[], oldList: number[]): number[]\n\t\t{\n\t\t\treturn newList.filter((chatId) => {\n\t\t\t\treturn !oldList.includes(chatId);\n\t\t\t});\n\t\t},\n\t\tgetRemovedElements(newList: number[], oldList: number[]): number[]\n\t\t{\n\t\t\treturn oldList.filter((chatId) => {\n\t\t\t\treturn !newList.includes(chatId);\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatDialog ref=\"dialog\" :dialogId=\"dialogId\" :resetOnExit=\"isGuest\">\n\t\t\t<template #message-list>\n\t\t\t\t<ChannelMessageList :dialogId=\"dialogId\" />\n\t\t\t</template>\n\t\t\t<template #additional-float-button>\n\t\t\t\t<Transition name=\"float-button-transition\">\n\t\t\t\t\t<CommentsButton\n\t\t\t\t\t\tv-if=\"showCommentsButton\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:counter=\"localTotalCommentsCounter\"\n\t\t\t\t\t\t@click=\"onCommentsButtonClick\"\n\t\t\t\t\t\tkey=\"comments\"\n\t\t\t\t\t/>\n\t\t\t\t</Transition>\n\t\t\t</template>\n\t\t</ChatDialog>\n\t`,\n};\n","import { ChatHeader } from '../../base/components/chat-header/chat-header';\n\n// @vue/component\nexport const ChannelHeader = {\n\tname: 'ChannelHeader',\n\tcomponents: { ChatHeader },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcurrentSidebarPanel: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatHeader :dialogId=\"dialogId\" :currentSidebarPanel=\"currentSidebarPanel\" />\n\t`,\n};\n","import { Button as ChatButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\n\n// @vue/component\nexport const JoinPanel = {\n\tcomponents: { ChatButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t},\n\tmethods:\n\t{\n\t\tonButtonClick()\n\t\t{\n\t\t\tthis.getChatService().joinChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__textarea_placeholder\">\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t:text=\"loc('IM_CONTENT_BLOCKED_TEXTAREA_JOIN_CHANNEL')\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ChatTextarea } from 'im.v2.component.textarea';\n\nimport '../css/textarea.css';\n\n// @vue/component\nexport const ChannelTextarea = {\n\tname: 'ChannelTextarea',\n\tcomponents: { ChatTextarea },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatTextarea\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:withCreateMenu=\"false\"\n\t\t\t:withMarket=\"false\"\n\t\t\tclass=\"bx-im-channel-send-panel__container\"\n\t\t/>\n\t`,\n};\n","import { BaseChatContent } from '../base/base';\nimport { ChannelDialog } from './components/dialog';\nimport { ChannelHeader } from './components/header';\nimport { JoinPanel } from './components/join-panel';\nimport { ChannelTextarea } from './components/textarea';\n\nexport const ChannelContent = {\n\tname: 'ChannelContent',\n\tcomponents: { BaseChatContent, ChannelHeader, ChannelDialog, ChannelTextarea, JoinPanel },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcommentsOpened: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseChatContent :dialogId=\"dialogId\" :commentsOpened=\"commentsOpened\">\n\t\t\t<template #header=\"{ currentSidebarPanel }\">\n\t\t\t\t<ChannelHeader :dialogId=\"dialogId\" :currentSidebarPanel=\"currentSidebarPanel\" :key=\"dialogId\" />\n\t\t\t</template>\n\t\t\t<template #dialog>\n\t\t\t\t<ChannelDialog :dialogId=\"dialogId\" :key=\"dialogId\" />\n\t\t\t</template>\n\t\t\t<template #join-panel>\n\t\t\t\t<JoinPanel :dialogId=\"dialogId\" />\n\t\t\t</template>\n\t\t\t<template #textarea=\"{ onTextareaMount }\">\n\t\t\t\t<ChannelTextarea :dialogId=\"dialogId\" :key=\"dialogId\" @mounted=\"onTextareaMount\" />\n\t\t\t</template>\n\t\t</BaseChatContent>\n\t`,\n};\n","import { ThemeManager } from 'im.v2.lib.theme';\nimport { RecentService } from 'im.v2.provider.service';\nimport { Layout } from 'im.v2.const';\n\nimport '../css/empty-state.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelLayout } from 'im.v2.model';\nimport type { BackgroundStyle } from 'im.v2.lib.theme';\n\n// @vue/component\nexport const EmptyState = {\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn this.isEmptyRecent ? '--empty' : '--default';\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.isEmptyRecent)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_CONTENT_CHAT_NO_CHATS_START_MESSAGE');\n\t\t\t}\n\n\t\t\tif (this.isChannelLayout)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_CONTENT_CHANNEL_START_MESSAGE');\n\t\t\t}\n\n\t\t\treturn this.loc('IM_CONTENT_CHAT_START_MESSAGE_V2');\n\t\t},\n\t\tsubtext(): string\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tisEmptyRecent(): boolean\n\t\t{\n\t\t\treturn RecentService.getInstance().getCollection().length === 0;\n\t\t},\n\t\tisChannelLayout(): boolean\n\t\t{\n\t\t\treturn this.layout.name === Layout.channel.name;\n\t\t},\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tbackgroundStyle(): BackgroundStyle\n\t\t{\n\t\t\treturn ThemeManager.getCurrentBackgroundStyle();\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat-start__container\" :style=\"backgroundStyle\">\n\t\t\t<div class=\"bx-im-content-chat-start__content\">\n\t\t\t\t<div class=\"bx-im-content-chat-start__icon\" :class=\"iconClass\"></div>\n\t\t\t\t<div class=\"bx-im-content-chat-start__title\">\n\t\t\t\t\t{{ text }}\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"subtext\" class=\"bx-im-content-chat-start__subtitle\">\n\t\t\t\t\t{{ subtext }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type, type JsonObject } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { Logger } from 'im.v2.lib.logger';\nimport { RestMethod } from 'im.v2.const';\n\ntype RawUser = {\n\tid: number,\n\t[key: string]: any,\n};\ntype PullUserActivityResult = {\n\t[userId: string]: number,\n};\n\nexport class UserService\n{\n\tasync updateLastActivityDate(userId: number): Promise\n\t{\n\t\tif (this.isPullServerWithUserStatusSupport())\n\t\t{\n\t\t\tconst lastActivityDate = await this.getUserActivityFromPull(userId);\n\t\t\tif (!lastActivityDate)\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\treturn this.updateUserModel(userId, { lastActivityDate });\n\t\t}\n\n\t\tconst userData = await this.requestUserData(userId);\n\n\t\treturn this.updateUserModel(userId, userData);\n\t}\n\n\tasync getUserActivityFromPull(userId: number): Promise<null | Date>\n\t{\n\t\tconst result: PullUserActivityResult = await Core.getPullClient().getUsersLastSeen([userId])\n\t\t\t.catch((error) => {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.error('UserService: error getting user activity from P&P', error);\n\t\t\t});\n\n\t\tif (!Type.isNumber(result[userId]))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst activityDateAgo = result[userId] * 1000;\n\n\t\treturn new Date(Date.now() - activityDateAgo);\n\t}\n\n\tasync requestUserData(userId: number): Promise<RawUser>\n\t{\n\t\tLogger.warn(`UserService: get actual user data for - ${userId}`);\n\t\tconst answer = await Core.getRestClient().callMethod(RestMethod.imUserGet, { ID: userId })\n\t\t\t.catch((error) => {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.error('UserService: error getting user data', error);\n\t\t\t});\n\n\t\treturn answer.data();\n\t}\n\n\tasync updateUserModel(userId: number, userFields: JsonObject): Promise\n\t{\n\t\tLogger.warn('UserService: update user data', userFields);\n\n\t\treturn Core.getStore().dispatch('users/update', {\n\t\t\tid: userId,\n\t\t\tfields: userFields,\n\t\t});\n\t}\n\n\tisPullServerWithUserStatusSupport(): boolean\n\t{\n\t\treturn Core.getPullClient().isJsonRpc();\n\t}\n}\n","import 'ui.notification';\n\nimport { Messenger } from 'im.public';\nimport { ChatType, Layout, UserRole } from 'im.v2.const';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { Logger } from 'im.v2.lib.logger';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ChatService } from 'im.v2.provider.service';\n\nimport { BaseChatContent } from '../../content/base/base';\nimport { ChannelContent } from '../../content/channel/channel';\nimport { EmptyState } from './components/empty-state';\nimport { UserService } from './classes/user-service';\n\nimport './css/default-chat-content.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelLayout } from 'im.v2.model';\n\n// @vue/component\nexport const ChatOpener = {\n\tname: 'ChatOpener',\n\tcomponents: { BaseChatContent, ChannelContent, EmptyState },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcommentsOpened: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisUser(): boolean\n\t\t{\n\t\t\treturn this.dialog.type === ChatType.user;\n\t\t},\n\t\tisChannel(): boolean\n\t\t{\n\t\t\treturn [ChatType.channel, ChatType.openChannel].includes(this.dialog.type);\n\t\t},\n\t\tisGuest(): boolean\n\t\t{\n\t\t\treturn this.dialog.role === UserRole.guest;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tdialogId(newValue, oldValue)\n\t\t{\n\t\t\tLogger.warn(`ChatContent: switching from ${oldValue || 'empty'} to ${newValue}`);\n\t\t\tthis.onChatChange();\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tif (!this.dialogId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onChatChange();\n\t},\n\tmethods:\n\t{\n\t\tasync onChatChange()\n\t\t{\n\t\t\tif (this.dialogId === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Utils.dialog.isExternalId(this.dialogId))\n\t\t\t{\n\t\t\t\tconst realDialogId = await this.getChatService().prepareDialogId(this.dialogId);\n\n\t\t\t\tvoid LayoutManager.getInstance().setLayout({\n\t\t\t\t\tname: Layout.chat.name,\n\t\t\t\t\tentityId: realDialogId,\n\t\t\t\t\tcontextId: this.layout.contextId,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dialog.inited)\n\t\t\t{\n\t\t\t\tLogger.warn(`ChatContent: chat ${this.dialogId} is already loaded`);\n\t\t\t\tif (this.isUser)\n\t\t\t\t{\n\t\t\t\t\tconst userId = parseInt(this.dialog.dialogId, 10);\n\t\t\t\t\tvoid this.getUserService().updateLastActivityDate(userId);\n\t\t\t\t}\n\t\t\t\telse if (this.isChannel && !this.isGuest)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn(`ChatContent: channel ${this.dialogId} is loaded, loading comments metadata`);\n\t\t\t\t\tvoid this.getChatService().loadCommentInfo(this.dialogId);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dialog.loading)\n\t\t\t{\n\t\t\t\tLogger.warn(`ChatContent: chat ${this.dialogId} is loading`);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.layout.contextId)\n\t\t\t{\n\t\t\t\tawait this.loadChatWithContext();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.loadChat();\n\t\t},\n\t\tasync loadChatWithContext(): Promise\n\t\t{\n\t\t\tLogger.warn(`ChatContent: loading chat ${this.dialogId} with context - ${this.layout.contextId}`);\n\n\t\t\tawait this.getChatService().loadChatWithContext(this.dialogId, this.layout.contextId)\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.handleChatLoadError(error);\n\t\t\t\t\tLogger.error(error);\n\t\t\t\t\tMessenger.openChat();\n\t\t\t\t});\n\n\t\t\tLogger.warn(`ChatContent: chat ${this.dialogId} is loaded with context of ${this.layout.contextId}`);\n\t\t},\n\t\tasync loadChat(): Promise\n\t\t{\n\t\t\tLogger.warn(`ChatContent: loading chat ${this.dialogId}`);\n\n\t\t\tawait this.getChatService().loadChatWithMessages(this.dialogId)\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.handleChatLoadError(error);\n\t\t\t\t\tLogger.error(error);\n\t\t\t\t\tMessenger.openChat();\n\t\t\t\t});\n\n\t\t\tLogger.warn(`ChatContent: chat ${this.dialogId} is loaded`);\n\t\t},\n\t\thandleChatLoadError(error: Error[]): void\n\t\t{\n\t\t\tconst [firstError] = error;\n\t\t\tif (firstError.code === 'ACCESS_DENIED')\n\t\t\t{\n\t\t\t\tthis.showNotification(this.loc('IM_CONTENT_CHAT_ACCESS_ERROR'));\n\t\t\t}\n\t\t\telse if (firstError.code === 'MESSAGE_NOT_FOUND')\n\t\t\t{\n\t\t\t\tthis.showNotification(this.loc('IM_CONTENT_CHAT_CONTEXT_MESSAGE_NOT_FOUND'));\n\t\t\t}\n\t\t},\n\t\tshowNotification(text: string)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({ content: text });\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tgetUserService(): UserService\n\t\t{\n\t\t\tif (!this.userService)\n\t\t\t{\n\t\t\t\tthis.userService = new UserService();\n\t\t\t}\n\n\t\t\treturn this.userService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-default-chat__container\">\n\t\t\t<EmptyState v-if=\"!dialogId\" />\n\t\t\t<ChannelContent v-else-if=\"isChannel\" :dialogId=\"dialogId\" :commentsOpened=\"commentsOpened\" />\n\t\t\t<BaseChatContent\n\t\t\t\tv-else\n\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\tclass=\"bx-im-content-comments__container\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Core } from 'im.v2.application.core';\nimport { runAction } from 'im.v2.lib.rest';\nimport { RestMethod } from 'im.v2.const';\n\nexport const CommentsService = {\n\tsubscribe(dialogId: string): Promise\n\t{\n\t\tCore.getStore().dispatch('chats/unmute', { dialogId });\n\n\t\treturn runAction(RestMethod.imV2ChatCommentSubscribe, {\n\t\t\tdata: { dialogId },\n\t\t}).catch((error) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error('CommentsService: subscribe error', error);\n\t\t});\n\t},\n\n\tunsubscribe(dialogId: string): Promise\n\t{\n\t\tCore.getStore().dispatch('chats/mute', { dialogId });\n\n\t\treturn runAction(RestMethod.imV2ChatCommentUnsubscribe, {\n\t\t\tdata: { dialogId },\n\t\t}).catch((error) => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error('CommentsService: unsubscribe error', error);\n\t\t});\n\t},\n};\n","import { Core } from 'im.v2.application.core';\nimport { Toggle, ToggleSize } from 'im.v2.component.elements';\n\nimport { CommentsService } from '../classes/comments-service';\n\nimport '../css/follow-toggle.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const FollowToggle = {\n\tname: 'FollowToggle',\n\tcomponents: { Toggle },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tToggleSize: () => ToggleSize,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tisFollowed(): boolean\n\t\t{\n\t\t\treturn !this.dialog.muteList.includes(Core.getUserId());\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonToggleClick(): void\n\t\t{\n\t\t\tif (this.isFollowed)\n\t\t\t{\n\t\t\t\tCommentsService.unsubscribe(this.dialogId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tCommentsService.subscribe(this.dialogId);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div @click=\"onToggleClick\" class=\"bx-im-comments-header-follow__container\">\n\t\t\t<div class=\"bx-im-comments-header-follow__text\">{{ loc('IM_CONTENT_COMMENTS_FOLLOW_TOGGLE_TEXT') }}</div>\n\t\t\t<Toggle :size=\"ToggleSize.M\" :isEnabled=\"isFollowed\" />\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\n\nimport { EventType, ChatActionType } from 'im.v2.const';\nimport { Avatar, AvatarSize } from 'im.v2.component.elements';\nimport { PermissionManager } from 'im.v2.lib.permission';\n\nimport { ChatHeader } from '../../base/components/chat-header/chat-header';\nimport { FollowToggle } from './follow-toggle';\n\nimport '../css/header.css';\n\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const CommentsHeader = {\n\tname: 'CommentsHeader',\n\tcomponents: { ChatHeader, Avatar, FollowToggle },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tchannelId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentSidebarPanel: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tAvatarSize: () => AvatarSize,\n\t\tchannel(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.channelId, true);\n\t\t},\n\t\tshowFollowToggle(): boolean\n\t\t{\n\t\t\treturn PermissionManager.getInstance().canPerformAction(ChatActionType.followComments, this.dialogId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonBackClick()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.dialog.closeComments);\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatHeader\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:currentSidebarPanel=\"currentSidebarPanel\"\n\t\t\tclass=\"bx-im-comment-header__container\"\n\t\t>\n\t\t\t<template #left>\n\t\t\t\t<div @click=\"onBackClick\" class=\"bx-im-comment-header__back\"></div>\n\t\t\t\t<div class=\"bx-im-comment-header__info\">\n\t\t\t\t\t<div class=\"bx-im-comment-header__title\">{{ loc('IM_CONTENT_COMMENTS_HEADER_TITLE') }}</div>\n\t\t\t\t\t<div class=\"bx-im-comment-header__subtitle\">\n\t\t\t\t\t\t<div class=\"bx-im-comment-header__subtitle_avatar\">\n\t\t\t\t\t\t\t<Avatar :dialogId=\"channelId\" :size=\"AvatarSize.XS\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-comment-header__subtitle_text\">{{ channel.name }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"showFollowToggle\" #before-actions>\n\t\t\t\t<FollowToggle :dialogId=\"dialogId\" />\n\t\t\t</template>\n\t\t</ChatHeader>\n\t`,\n};\n","import { type JsonObject } from 'main.core';\n\nimport '../css/dialog-loader.css';\n\n// @vue/component\nexport const CommentsDialogLoader = {\n\tname: 'CommentsDialogLoader',\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-comments-dialog-loader__container\">\n\t\t\t<div class=\"bx-im-comments-dialog-loader__spinner\"></div>\n\t\t</div>\n\t`,\n};\n","import { ChatType } from 'im.v2.const';\nimport { MessageMenu } from 'im.v2.component.message-list';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelChat } from 'im.v2.model';\n\nexport class CommentsMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn [\n\t\t\tthis.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\t// this.getPinItem(),\n\t\t\t// this.getForwardItem(),\n\t\t\tthis.getDelimiter(),\n\t\t\t// this.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getDelimiter(),\n\t\t\tthis.getCreateItem(),\n\t\t\tthis.getDelimiter(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDisk(),\n\t\t\tthis.getDelimiter(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetReplyItem(): ?MenuItem\n\t{\n\t\tif (this.isPostMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn super.getReplyItem();\n\t}\n\n\tgetEditItem(): ?MenuItem\n\t{\n\t\tif (this.isPostMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn super.getEditItem();\n\t}\n\n\tgetDeleteItem(): ?MenuItem\n\t{\n\t\tif (this.isPostMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn super.getDeleteItem();\n\t}\n\n\tgetCreateItem(): ?MenuItem\n\t{\n\t\tif (this.isPostMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn super.getCreateItem();\n\t}\n\n\tisPostMessage(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/getByChatId'](this.context.chatId);\n\n\t\treturn [ChatType.openChannel, ChatType.channel].includes(type);\n\t}\n}\n","import {\n\tMessageList,\n\tAuthorGroup,\n\tMessageComponents,\n\tCollectionManager,\n\tMessageComponentManager,\n} from 'im.v2.component.message-list';\nimport { MessageComponent } from 'im.v2.const';\n\nimport { CommentsDialogLoader } from './dialog-loader';\nimport { CommentsMessageMenu } from '../classes/message-menu';\n\nimport '../css/message-list.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelMessage } from 'im.v2.model';\n\n// @vue/component\nexport const CommentsMessageList = {\n\tname: 'CommentsMessageList',\n\tcomponents: { MessageList, CommentsDialogLoader, AuthorGroup, ...MessageComponents },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tCommentsMessageMenu: () => CommentsMessageMenu,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tshowPostMessage(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited && !this.dialog.hasPrevPage;\n\t\t},\n\t\tpostMessageId(): number\n\t\t{\n\t\t\treturn this.$store.getters['messages/comments/getMessageIdByChatId'](this.dialog.chatId);\n\t\t},\n\t\tpostMessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.postMessageId);\n\t\t},\n\t\tpostAuthorGroup(): JsonObject | null\n\t\t{\n\t\t\tif (!this.dialog.inited)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst collectionManager = new CollectionManager(this.dialogId);\n\n\t\t\treturn collectionManager.formatAuthorGroup(this.postMessage);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonPostMessageMouseUp(message: ImModelMessage, event: MouseEvent)\n\t\t{\n\t\t\tthis.$refs.messageList.onMessageMouseUp(message, event);\n\t\t},\n\t\tgetMessageComponentName(message: ImModelMessage): $Values<typeof MessageComponent>\n\t\t{\n\t\t\treturn (new MessageComponentManager(message)).getName();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessageList\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:messageMenuClass=\"CommentsMessageMenu\"\n\t\t\tref=\"messageList\"\n\t\t>\n\t\t\t<template #loader>\n\t\t\t\t<CommentsDialogLoader />\n\t\t\t</template>\n\t\t\t<template v-if=\"showPostMessage\" #before-messages>\n\t\t\t\t<div class=\"bx-im-comments-message-list__channel-post\">\n\t\t\t\t\t<AuthorGroup :item=\"postAuthorGroup\">\n\t\t\t\t\t\t<template #message>\n\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\t:is=\"getMessageComponentName(postMessage)\"\n\t\t\t\t\t\t\t\t:item=\"postMessage\"\n\t\t\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t\t\t:key=\"postMessage.id\"\n\t\t\t\t\t\t\t\t@mouseup=\"onPostMessageMouseUp(postMessage, $event)\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</component>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</AuthorGroup>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</MessageList>\n\t`,\n};\n","import { Logger } from 'im.v2.lib.logger';\nimport { ImModelMessage } from 'im.v2.model';\n\nimport { ChatDialog, PinnedMessages } from 'im.v2.component.dialog.chat';\n\nimport { CommentsMessageList } from './message-list';\n\nimport type { ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const CommentsDialog = {\n\tname: 'CommentsDialog',\n\tcomponents: { ChatDialog, CommentsMessageList, PinnedMessages },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId, true);\n\t\t},\n\t\tdialogInited(): boolean\n\t\t{\n\t\t\treturn this.dialog.inited;\n\t\t},\n\t\tpostMessageId(): number\n\t\t{\n\t\t\treturn this.$store.getters['messages/comments/getMessageIdByChatId'](this.dialog.chatId);\n\t\t},\n\t\tpostMessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.$store.getters['messages/getById'](this.postMessageId);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tasync goToPostMessageContext()\n\t\t{\n\t\t\tconst dialog = this.$refs.dialog;\n\n\t\t\tconst postMessageIsShown = this.dialogInited && !this.dialog.hasPrevPage;\n\t\t\tif (postMessageIsShown)\n\t\t\t{\n\t\t\t\tawait dialog.getScrollManager().animatedScrollToMessage(this.postMessageId);\n\t\t\t\tdialog.highlightMessage(this.postMessageId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdialog.showLoadingBar();\n\t\t\tawait dialog.getMessageService().loadFirstPage()\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tLogger.error('goToMessageContext error', error);\n\t\t\t\t});\n\t\t\tawait this.$nextTick();\n\t\t\tdialog.hideLoadingBar();\n\t\t\tdialog.getScrollManager().scrollToMessage(this.postMessageId);\n\t\t\tawait this.$nextTick();\n\t\t\tdialog.highlightMessage(this.postMessageId);\n\t\t},\n\t\tonPinnedPostMessageClick()\n\t\t{\n\t\t\tthis.goToPostMessageContext();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatDialog ref=\"dialog\" :dialogId=\"dialogId\" :saveScrollOnExit=\"false\" :resetOnExit=\"true\">\n\t\t\t<template v-if=\"dialogInited\" #pinned-panel>\n\t\t\t\t<PinnedMessages\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:messages=\"[postMessage]\"\n\t\t\t\t\t@messageClick=\"onPinnedPostMessageClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template #message-list>\n\t\t\t\t<CommentsMessageList :dialogId=\"dialogId\" />\n\t\t\t</template>\n\t\t</ChatDialog>\n\t`,\n};\n","import { ChatTextarea } from 'im.v2.component.textarea';\n\nimport '../css/textarea.css';\n\n// @vue/component\nexport const CommentsTextarea = {\n\tname: 'CommentsTextarea',\n\tcomponents: { ChatTextarea },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatTextarea\n\t\t\t:dialogId=\"dialogId\"\n\t\t\t:withMarket=\"false\"\n\t\t\tclass=\"bx-im-comments-send-panel__container\"\n\t\t/>\n\t`,\n};\n","import { Button as ChatButton, ButtonColor, ButtonSize } from 'im.v2.component.elements';\nimport { ChatService } from 'im.v2.provider.service';\n\n// @vue/component\nexport const JoinPanel = {\n\tcomponents: { ChatButton },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t},\n\tmethods:\n\t{\n\t\tonButtonClick()\n\t\t{\n\t\t\tthis.getChatService().joinChat(this.dialogId);\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t\tloc(phraseCode: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-chat__textarea_placeholder\">\n\t\t\t<ChatButton\n\t\t\t\t:size=\"ButtonSize.XL\"\n\t\t\t\t:color=\"ButtonColor.Primary\"\n\t\t\t\t:text=\"loc('IM_CONTENT_BLOCKED_TEXTAREA_JOIN_CHANNEL')\"\n\t\t\t\t:isRounded=\"true\"\n\t\t\t\t@click=\"onButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { BaseChatContent } from '../base/base';\nimport { CommentsHeader } from './components/header';\nimport { CommentsDialog } from './components/dialog';\nimport { CommentsTextarea } from './components/textarea';\nimport { JoinPanel } from './components/join-panel';\n\nimport './css/comments-content.css';\n\nexport const CommentsContent = {\n\tname: 'CommentsContent',\n\tcomponents: { BaseChatContent, CommentsHeader, CommentsDialog, CommentsTextarea, JoinPanel },\n\tprops:\n\t{\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tchannelId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseChatContent :dialogId=\"dialogId\">\n\t\t\t<template #header=\"{ currentSidebarPanel }\">\n\t\t\t\t<CommentsHeader\n\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t:channelId=\"channelId\"\n\t\t\t\t\t:currentSidebarPanel=\"currentSidebarPanel\"\n\t\t\t\t\t:key=\"dialogId\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template #dialog>\n\t\t\t\t<CommentsDialog :dialogId=\"dialogId\" :key=\"dialogId\" />\n\t\t\t</template>\n\t\t\t<template #join-panel>\n\t\t\t\t<JoinPanel :dialogId=\"dialogId\" />\n\t\t\t</template>\n\t\t\t<template #textarea=\"{ onTextareaMount }\">\n\t\t\t\t<CommentsTextarea :dialogId=\"dialogId\" :key=\"dialogId\" @mounted=\"onTextareaMount\" />\n\t\t\t</template>\n\t\t</BaseChatContent>\n\t`,\n};\n","import 'ui.notification';\n\nimport { Logger } from 'im.v2.lib.logger';\nimport { ChatService, MessageService } from 'im.v2.provider.service';\n\nimport { CommentsContent } from '../../content/comments/comments';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelChat, ImModelCommentInfo } from 'im.v2.model';\n\n// @vue/component\nexport const CommentsOpener = {\n\tname: 'CommentsOpener',\n\tcomponents: { CommentsContent },\n\tprops:\n\t{\n\t\tpostId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tchannelId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): JsonObject\n\t{\n\t\treturn {};\n\t},\n\tcomputed:\n\t{\n\t\tdialog(): ?ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/getByChatId'](this.commentsChatId);\n\t\t},\n\t\tcommentInfo(): ImModelCommentInfo\n\t\t{\n\t\t\treturn this.$store.getters['messages/comments/getByMessageId'](this.postId);\n\t\t},\n\t\tcommentsChatId(): number\n\t\t{\n\t\t\treturn this.commentInfo.chatId;\n\t\t},\n\t\tcommentsDialogId(): string\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.dialog.dialogId;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.onCreated();\n\t},\n\tmethods:\n\t{\n\t\tasync onCreated()\n\t\t{\n\t\t\tawait this.loadChat();\n\t\t},\n\t\tasync loadChat(): Promise\n\t\t{\n\t\t\tLogger.warn(`CommentsContent: loading comments for post ${this.postId}`);\n\n\t\t\tawait this.getChatService().loadComments(this.postId)\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.handleChatLoadError(error);\n\t\t\t\t\tLogger.error(error);\n\t\t\t\t\tthis.$emit('close');\n\t\t\t\t});\n\n\t\t\tLogger.warn(`CommentsContent: comments for post ${this.postId} are loaded`);\n\t\t},\n\t\thandleChatLoadError(error: Error[]): void\n\t\t{\n\t\t\tconst [firstError] = error;\n\t\t\tif (firstError.code === 'ACCESS_DENIED')\n\t\t\t{\n\t\t\t\tthis.showNotification(this.loc('IM_CONTENT_CHAT_ACCESS_ERROR'));\n\t\t\t}\n\t\t},\n\t\tshowNotification(text: string)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({ content: text });\n\t\t},\n\t\tgetChatService(): ChatService\n\t\t{\n\t\t\tif (!this.chatService)\n\t\t\t{\n\t\t\t\tthis.chatService = new ChatService();\n\t\t\t}\n\n\t\t\treturn this.chatService;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-comments__container\">\n\t\t\t<CommentsContent :dialogId=\"commentsDialogId\" :channelId=\"channelId\" />\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport { EventType } from 'im.v2.const';\n\nimport { ChatOpener } from './components/openers/chat/chat';\nimport { CommentsOpener } from './components/openers/comments/comments';\n\nimport './css/chat-content.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelLayout } from 'im.v2.model';\n\n// @vue/component\nexport const ChatContent = {\n\tname: 'ChatContent',\n\tcomponents:\n\t{\n\t\tChatOpener,\n\t\tCommentsOpener,\n\t},\n\tprops:\n\t{\n\t\tentityId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tcommentsPostId: 0,\n\t\t\tcommentsAnimationFlag: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tlayout(): ImModelLayout\n\t\t{\n\t\t\treturn this.$store.getters['application/getLayout'];\n\t\t},\n\t\tshowComments(): boolean\n\t\t{\n\t\t\treturn this.commentsPostId > 0;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tlayout(newValue: ImModelLayout)\n\t\t{\n\t\t\tthis.closeComments();\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.dialog.openComments, this.onOpenComments);\n\t\tEventEmitter.subscribe(EventType.dialog.closeComments, this.onCloseComments);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.dialog.openComments, this.onOpenComments);\n\t\tEventEmitter.unsubscribe(EventType.dialog.closeComments, this.onCloseComments);\n\t},\n\tmethods:\n\t{\n\t\tonOpenComments(event: BaseEvent<{ messageId: number }>)\n\t\t{\n\t\t\tconst { messageId } = event.getData();\n\t\t\tthis.commentsPostId = messageId;\n\t\t\tthis.commentsAnimationFlag = true;\n\t\t},\n\t\tonCloseComments()\n\t\t{\n\t\t\tthis.closeComments();\n\t\t},\n\t\tcloseComments()\n\t\t{\n\t\t\tthis.commentsPostId = 0;\n\t\t},\n\t\tonCommentsAnimationEnd()\n\t\t{\n\t\t\tthis.commentsAnimationFlag = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ChatOpener\n\t\t\t:commentsOpened=\"showComments\"\n\t\t\t:dialogId=\"entityId\"\n\t\t\t:class=\"{'--comments-show-animation': commentsAnimationFlag}\"\n\t\t/>\n\t\t<Transition name=\"comments-content\" @after-enter=\"onCommentsAnimationEnd\">\n\t\t\t<CommentsOpener\n\t\t\t\tv-if=\"showComments\"\n\t\t\t\t:postId=\"commentsPostId\"\n\t\t\t\t:channelId=\"entityId\"\n\t\t\t/>\n\t\t</Transition>\n\t`,\n};\n"],"names":["Height","chatHeader","pinnedMessages","blockedTextarea","dropAreaOffset","CallTypes","video","id","locCode","start","dialogId","Messenger","startVideoCall","audio","beta","dialog","Core","getStore","getters","CallManager","getInstance","createBetaCallRoom","chatId","CallMenu","BaseMenu","constructor","getMenuOptions","className","getMenuClassName","angle","offsetLeft","offsetTop","getMenuItems","delimiter","isAvailable","context","text","Loc","getMessage","onclick","emit","events","onMenuItemClick","menuInstance","close","disabled","phones","personalMobile","title","html","startPhoneCall","workPhone","innerPhone","settings","Extension","getSettings","isActive","get","classNames","isFeatureAvailable","push","join","BX","UI","InfoHelper","show","phoneNumber","Tag","render","getCurrentCallDialogId","chatCanBeCalled","chatIsAllowedToCall","PermissionManager","canPerformAction","ChatActionType","call","type","ChatType","user","runAction","RestMethod","imV2CallZoomCreate","data","catch","errors","errorText","notConnected","some","error","code","userProfileUri","getUserId","replace","Notification","Center","notify","content","CallButton","props","String","required","emits","lastCallType","computed","$store","isConference","videoconf","callButtonText","loc","created","getLastCallChoice","subscribeToMenuItemClick","methods","getCallMenu","subscribe","event","callTypeId","getData","saveLastCallChoice","callMenu","onButtonClick","onMenuClick","shouldShowMenu","openMenu","$refs","menu","onStartConferenceClick","openConference","public","result","LocalStorageManager","LocalStorageKey","isBitrixCallEnabled","set","phraseCode","$Bitrix","template","ParamsByLinkType","ChatEntityLinkType","tasks","calendar","sonetGroup","mail","contact","deal","lead","dynamic","EntityLink","name","entityType","entityLink","entityUrl","url","containerClassName","linkText","UserCounterPhraseCodeByChatType","openChannel","channel","default","GroupChatTitle","components","EditableChatTitle","LineLoader","FadeAnimation","hasEntityLink","Boolean","userCounterPhraseCode","userCounterText","getMessagePlural","userCounter","ONE_MINUTE","UserTitle","ChatTitle","userLastOnlineText","userPosition","userLastOnline","userLink","Utils","getProfileLink","watch","value","updateUserOnline","userLastOnlineInterval","setInterval","beforeUnmount","clearInterval","MultidialogChatTitle","isSupportBot","subtitle","Object","freeze","group","multidialog","ChatHeader","Avatar","AddToChat","UserChatTitle","currentSidebarPanel","showAddToChatPopup","AvatarSize","isInited","inited","isUser","isBot","bot","isChat","showCallButton","isSupport","showInviteButton","extend","showSidebarButton","openSidebar","canChangeAvatar","avatar","isSidebarOpened","length","isMessageSearchActive","SidebarDetailBlock","messageSearch","headerTitleComponentName","chatTitle","hasUserLink","toggleRightPanel","EventEmitter","EventType","sidebar","panel","open","main","toggleSearchPanel","onMembersClick","members","onNewTitleSubmit","newTitle","getChatService","renameChat","chatService","ChatService","openInvitePopup","onAvatarClick","avatarInput","click","onAvatarSelect","input","target","file","files","preparedAvatar","prepareAvatar","changeAvatar","replacements","DropArea","container","showDropArea","lastDropAreaEnterTarget","hasPinnedMessages","dropAreaStyles","offset","top","immediate","handler","newValue","Type","isElementNode","bindEvents","unbindEvents","Event","bind","onDragEnter","onDragLeave","onDragOver","onDrop","unbind","stopPropagation","preventDefault","success","hasDataTransferOnlyFiles","dataTransfer","getFilesFromDataTransfer","getUploadingService","addFilesFromInput","uploadingService","UploadingService","BUTTON_BACKGROUND_COLOR","BUTTON_HOVER_COLOR","BUTTON_TEXT_COLOR","MutePanel","ChatButton","ButtonSize","isMuted","muteList","includes","buttonText","mutedCode","unmutedCode","buttonColorScheme","borderColor","Color","transparent","backgroundColor","iconColor","textColor","hoverColor","unmuteChat","muteChat","JoinPanel","ButtonColor","joinChat","LoadingBar","TextareaObserverDirective","mounted","element","binding","instance","textareaResizeManager","observeTextarea","unobserveTextarea","BaseChatContent","ChatDialog","ChatTextarea","ChatSidebar","directives","commentsOpened","textareaHeight","showLoadingBar","canSend","send","isGuest","role","UserRole","guest","containerClasses","alignment","Settings","appearance","backgroundStyle","ThemeManager","getCurrentBackgroundStyle","dialogContainerStyle","height","oldValue","scrollToBottom","animation","initTextareaResizeManager","ResizeManager","onHeightChange","onTextareaHeightChange","onTextareaMount","textareaContainer","clientHeight","newHeight","onChangeSidebarPanel","onShowLoadingBar","onHideLoadingBar","hideLoadingBar","unsubscribe","CommentsButton","counter","Number","ChannelMessageMenu","MessageMenu","getCopyItem","getCopyLinkItem","getCopyFileItem","getPinItem","getForwardItem","getDelimiter","getMarkItem","getFavoriteItem","getDownloadFileItem","getSaveToDisk","getEditItem","getDeleteItem","ChannelMessageList","MessageList","ChannelDialog","localCommentsCounterMap","layout","isChatLayout","Layout","chat","realCommentsWithCounter","realCommentsCounterMap","map","forEach","commentChatId","channelId","localCommentsQueue","keys","key","localTotalCommentsCounter","values","singleCounter","showCommentsButton","newList","oldList","addedChatIds","getAddedElements","addedChatId","removedChatIds","getRemovedElements","removedChatId","onCommentsButtonClick","chatIdToJump","messageIdToJump","goToMessageContext","goToMessageContextByCommentsChatId","messageId","getMessageService","loadContextByChatId","console","$nextTick","getScrollManager","scrollToMessage","highlightMessage","filter","ChannelHeader","ChannelTextarea","ChannelContent","EmptyState","iconClass","isEmptyRecent","isChannelLayout","subtext","RecentService","getCollection","UserService","updateLastActivityDate","userId","isPullServerWithUserStatusSupport","lastActivityDate","getUserActivityFromPull","Promise","resolve","updateUserModel","userData","requestUserData","getPullClient","getUsersLastSeen","isNumber","activityDateAgo","Date","now","Logger","warn","answer","getRestClient","callMethod","imUserGet","ID","userFields","dispatch","fields","isJsonRpc","ChatOpener","isChannel","onChatChange","isExternalId","realDialogId","prepareDialogId","LayoutManager","setLayout","entityId","contextId","parseInt","getUserService","loadCommentInfo","loading","loadChatWithContext","loadChat","handleChatLoadError","openChat","loadChatWithMessages","firstError","showNotification","userService","CommentsService","imV2ChatCommentSubscribe","imV2ChatCommentUnsubscribe","FollowToggle","Toggle","ToggleSize","isFollowed","onToggleClick","CommentsHeader","showFollowToggle","followComments","onBackClick","closeComments","CommentsDialogLoader","CommentsMessageMenu","getReplyItem","getCreateItem","isPostMessage","store","CommentsMessageList","AuthorGroup","MessageComponents","showPostMessage","hasPrevPage","postMessageId","postMessage","postAuthorGroup","collectionManager","CollectionManager","formatAuthorGroup","onPostMessageMouseUp","message","messageList","onMessageMouseUp","getMessageComponentName","MessageComponentManager","getName","CommentsDialog","PinnedMessages","dialogInited","goToPostMessageContext","postMessageIsShown","animatedScrollToMessage","loadFirstPage","onPinnedPostMessageClick","CommentsTextarea","CommentsContent","CommentsOpener","postId","commentsChatId","commentInfo","commentsDialogId","onCreated","loadComments","$emit","ChatContent","commentsPostId","commentsAnimationFlag","showComments","openComments","onOpenComments","onCloseComments","onCommentsAnimationEnd"],"mappings":"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"}