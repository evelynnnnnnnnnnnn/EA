{"version":3,"file":"file-message.bundle.js","sources":["../src/components/items/progress-bar.js","../src/components/items/image.js","../src/components/image-message.js","../src/classes/base-file-context-menu.js","../src/components/items/base-file.js","../src/components/base-file-message.js","../src/components/items/video.js","../src/components/video-message.js","../src/components/items/audio.js","../src/components/audio-message.js","../src/file-message.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\n\nimport { EventType } from 'im.v2.const';\nimport { ProgressBarManager } from 'im.v2.lib.progressbar';\n\nimport '../../css/items/progress-bar.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const ProgressBar = {\n\tname: 'ProgressBar',\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\t'file.status': function()\n\t\t{\n\t\t\tthis.getProgressBarManager().update();\n\t\t},\n\t\t'file.progress': function()\n\t\t{\n\t\t\tthis.getProgressBarManager().update();\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.initProgressBar();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.removeProgressBar();\n\t},\n\tmethods:\n\t{\n\t\tinitProgressBar()\n\t\t{\n\t\t\tif (this.file.progress === 100)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet blurElement;\n\t\t\tif (this.file.progress < 0 || (!this.isImage && !this.isVideo))\n\t\t\t{\n\t\t\t\tblurElement = false;\n\t\t\t}\n\n\t\t\tthis.progressBarManager = new ProgressBarManager({\n\t\t\t\tcontainer: this.$refs['progress-bar'],\n\t\t\t\tuploadState: this.file,\n\t\t\t\tcustomConfig: { blurElement, hasTitle: false },\n\t\t\t});\n\n\t\t\tthis.progressBarManager.subscribe(ProgressBarManager.event.cancel, () => {\n\t\t\t\tEventEmitter.emit(EventType.uploader.cancel, {\n\t\t\t\t\ttempFileId: this.file.id,\n\t\t\t\t\ttempMessageId: this.messageId,\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.progressBarManager.subscribe(ProgressBarManager.event.destroy, () => {\n\t\t\t\tif (this.progressBar)\n\t\t\t\t{\n\t\t\t\t\tthis.progressBar = null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.progressBarManager.start();\n\t\t},\n\t\tremoveProgressBar()\n\t\t{\n\t\t\tif (!this.getProgressBarManager())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getProgressBarManager().destroy();\n\t\t},\n\t\tgetProgressBarManager(): ProgressBarManager\n\t\t{\n\t\t\treturn this.progressBarManager;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-progress-bar__container\" ref=\"progress-bar\"></div>\n\t`,\n};\n","import { Type, type JsonObject } from 'main.core';\nimport { lazyload } from 'ui.vue3.directives.lazyload';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { ImModelMessage } from 'im.v2.model';\n\nimport { ProgressBar } from './progress-bar';\n\nimport type { ImModelFile } from 'im.v2.model';\n\nimport '../../css/items/image.css';\n\nconst MAX_WIDTH = 420;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\n\n// @vue/component\nexport const ImageItem = {\n\tname: 'ImageItem',\n\tdirectives: { lazyload },\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmessageItem(): ImModelMessage\n\t\t{\n\t\t\treturn this.message;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\timageTitle(): string\n\t\t{\n\t\t\tconst size = Utils.file.formatFileSize(this.file.size);\n\n\t\t\treturn this.loc(\n\t\t\t\t'IM_ELEMENTS_MEDIA_IMAGE_TITLE',\n\t\t\t\t{\n\t\t\t\t\t'#NAME#': this.file.name,\n\t\t\t\t\t'#SIZE#': size,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.messageItem.forward.id);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tv-bind=\"viewerAttributes\" \n\t\t\tclass=\"bx-im-media-image__container\" \n\t\t\t:class=\"{'--with-forward': isForward}\"\n\t\t\t@click=\"download\"\n\t\t\t:style=\"imageSize\"\n\t\t>\n\t\t\t<img\n\t\t\t\tv-lazyload\n\t\t\t\tdata-lazyload-dont-hide\n\t\t\t\t:data-lazyload-src=\"file.urlShow\"\n\t\t\t\t:title=\"imageTitle\"\n\t\t\t\t:alt=\"file.name\"\n\t\t\t\tclass=\"bx-im-media-image__source\"\n\t\t\t/>\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageItem.id\" />\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport {\n\tMessageStatus,\n\tReactionList,\n\tDefaultMessageContent,\n\tMessageHeader,\n\tMessageFooter,\n} from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { ChatType, FileType } from 'im.v2.const';\n\nimport { ImageItem } from './items/image';\n\nimport '../css/image-messsage.css';\n\nimport type { ImModelMessage, ImModelFile, ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const ImageMessage = {\n\tname: 'ImageMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tImageItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId);\n\t\t},\n\t\tonlyImage(): boolean\n\t\t{\n\t\t\treturn this.message.text.length === 0 && this.message.attach.length === 0;\n\t\t},\n\t\thasText(): boolean\n\t\t{\n\t\t\treturn this.message.text.length > 0;\n\t\t},\n\t\thasAttach(): boolean\n\t\t{\n\t\t\treturn this.message.attach.length > 0;\n\t\t},\n\t\tisChannelPost(): boolean\n\t\t{\n\t\t\treturn [ChatType.channel, ChatType.openChannel].includes(this.dialog.type);\n\t\t},\n\t\tshowContextMenu(): boolean\n\t\t{\n\t\t\treturn this.onlyImage;\n\t\t},\n\t\tshowBottomContainer(): boolean\n\t\t{\n\t\t\treturn this.hasText || this.hasAttach || this.isChannelPost;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-image__container\">\n\t\t\t\t<MessageHeader :withTitle=\"false\" :item=\"item\" class=\"bx-im-message-image__header\" />\n\t\t\t\t<div class=\"bx-im-message-image__content\">\n\t\t\t\t\t<ImageItem\n\t\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div v-if=\"onlyImage\" class=\"bx-im-message-image__message-status-container\">\n\t\t\t\t\t\t<MessageStatus :item=\"message\" :isOverlay=\"onlyImage\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showBottomContainer\" class=\"bx-im-message-image__bottom-container\">\n\t\t\t\t\t<DefaultMessageContent\n\t\t\t\t\t\tv-if=\"hasText || hasAttach\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:withText=\"hasText\"\n\t\t\t\t\t\t:withAttach=\"hasAttach\"\n\t\t\t\t\t/>\n\t\t\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template #after-message>\n\t\t\t\t<div v-if=\"onlyImage\" class=\"bx-im-message-image__reaction-list-container\">\n\t\t\t\t\t<ReactionList :messageId=\"message.id\" />\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</BaseMessage>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nimport { DiskService } from 'im.v2.provider.service';\nimport { BaseMenu } from 'im.v2.lib.menu';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PopupType } from 'im.v2.const';\n\nimport type { MenuItem } from 'im.v2.lib.menu';\nimport type { ImModelFile } from 'im.v2.model';\n\nexport class BaseFileContextMenu extends BaseMenu\n{\n\tid: String = PopupType.messageBaseFileMenu;\n\tdiskService: DiskService;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-message-file-context-menu';\n\t\tthis.diskService = new DiskService();\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn [\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDisk(),\n\t\t];\n\t}\n\n\tgetDownloadFileItem(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\thtml: Utils.file.createDownloadLink(\n\t\t\t\tLoc.getMessage('IM_MESSAGE_FILE_MENU_DOWNLOAD_FILE'),\n\t\t\t\tfile.urlDownload,\n\t\t\t\tfile.name,\n\t\t\t),\n\t\t\tonclick: function() {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\tgetSaveToDisk(): ?MenuItem\n\t{\n\t\tconst file = this.#getMessageFile();\n\t\tif (!file)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttext: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK'),\n\t\t\tonclick: function() {\n\t\t\t\tvoid this.diskService.save(file.id).then(() => {\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Loc.getMessage('IM_MESSAGE_FILE_MENU_SAVE_ON_DISK_SUCCESS'),\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\t#getMessageFile(): ?ImModelFile\n\t{\n\t\tif (this.context.files.length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\t// for now, we have only one file in one message. In the future we need to change this logic.\n\t\treturn this.store.getters['files/get'](this.context.files[0]);\n\t}\n}\n","import 'ui.icons.disk';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { ProgressBar } from './progress-bar';\nimport { BaseFileContextMenu } from '../../classes/base-file-context-menu';\n\nimport '../../css/items/base-file.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileItem = {\n\tname: 'BaseFileItem',\n\tcomponents: { ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tfileShortName(): string\n\t\t{\n\t\t\tconst NAME_MAX_LENGTH = 40;\n\n\t\t\treturn Utils.file.getShortFileName(this.file.name, NAME_MAX_LENGTH);\n\t\t},\n\t\tfileSize(): string\n\t\t{\n\t\t\treturn Utils.file.formatFileSize(this.file.size);\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst iconType = Utils.file.getIconTypeByFilename(this.file.name);\n\n\t\t\treturn `ui-icon-file-${iconType}`;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\topenContextMenu(event: PointerEvent)\n\t\t{\n\t\t\tthis.$emit('openContextMenu', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-base-file-item__container bx-im-base-file-item__scope\">\n\t\t\t<div class=\"bx-im-base-file-item__icon-container\" ref=\"loader-icon\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<div v-if=\"isLoaded\" :class=\"iconClass\" class=\"bx-im-base-file-item__type-icon ui-icon\"><i></i></div>\n\t\t\t\t<ProgressBar v-else :item=\"file\" :messageId=\"messageId\" />\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-base-file-item__content\" v-bind=\"viewerAttributes\" @click=\"download\">\n\t\t\t\t<span :title=\"file.name\" class=\"bx-im-base-file-item__title\">\n\t\t\t\t\t{{ fileShortName }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"bx-im-base-file-item__size\">{{ fileSize }}</div>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tclass=\"bx-im-base-file-item__download-icon\"\n\t\t\t\t:class=\"{'--not-active': !isLoaded}\"\n\t\t\t\t@click=\"openContextMenu\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType } from 'im.v2.const';\n\nimport { BaseFileContextMenu } from '../classes/base-file-context-menu';\nimport { BaseFileItem } from './items/base-file';\n\nimport '../css/base-file-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const BaseFileMessage = {\n\tname: 'BaseFileMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tDefaultMessageContent,\n\t\tBaseFileItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.contextMenu = new BaseFileContextMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.contextMenu.destroy();\n\t},\n\tmethods:\n\t{\n\t\tonOpenContextMenu(event: PointerEvent)\n\t\t{\n\t\t\tconst context = { dialogId: this.dialogId, ...this.message };\n\t\t\tthis.contextMenu.openMenu(context, event.target);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-base-file__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-base-file__author-title\" />\n\t\t\t\t<BaseFileItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t@openContextMenu=\"onOpenContextMenu\"\n\t\t\t\t/>\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`,\n};\n","import { ImModelMessage } from 'im.v2.model';\nimport { Type } from 'main.core';\nimport { SocialVideo } from 'ui.vue3.components.socialvideo';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/video.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\nconst VIDEO_SIZE_TO_AUTOPLAY = 5_000_000;\nconst MAX_WIDTH = 420;\nconst MAX_HEIGHT = 340;\nconst MIN_WIDTH = 200;\nconst MIN_HEIGHT = 100;\nconst DEFAULT_WIDTH = 320;\nconst DEFAULT_HEIGHT = 180;\n\n// @vue/component\nexport const VideoItem = {\n\tname: 'VideoItem',\n\tcomponents: { SocialVideo, ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tmessageItem(): ImModelMessage\n\t\t{\n\t\t\treturn this.message;\n\t\t},\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tautoplay(): boolean\n\t\t{\n\t\t\treturn this.file.size < VIDEO_SIZE_TO_AUTOPLAY;\n\t\t},\n\t\tcanBeOpenedWithViewer(): boolean\n\t\t{\n\t\t\treturn this.file.viewerAttrs && BX.UI?.Viewer;\n\t\t},\n\t\tviewerAttributes(): Object\n\t\t{\n\t\t\treturn Utils.file.getViewerDataAttributes(this.file.viewerAttrs);\n\t\t},\n\t\timageSize(): {width: string, height: string, backgroundSize: string}\n\t\t{\n\t\t\tlet newWidth = this.file.image.width;\n\t\t\tlet newHeight = this.file.image.height;\n\n\t\t\tif (!newHeight || !newWidth)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\twidth: `${DEFAULT_WIDTH}px`,\n\t\t\t\t\theight: `${DEFAULT_HEIGHT}px`,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (this.file.image.width > MAX_WIDTH || this.file.image.height > MAX_HEIGHT)\n\t\t\t{\n\t\t\t\tconst aspectRatio = this.file.image.width / this.file.image.height;\n\n\t\t\t\tif (this.file.image.width > MAX_WIDTH)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = MAX_WIDTH;\n\t\t\t\t\tnewHeight = Math.round(MAX_WIDTH / aspectRatio);\n\t\t\t\t}\n\n\t\t\t\tif (newHeight > MAX_HEIGHT)\n\t\t\t\t{\n\t\t\t\t\tnewWidth = Math.round(MAX_HEIGHT * aspectRatio);\n\t\t\t\t\tnewHeight = MAX_HEIGHT;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst sizes = {\n\t\t\t\twidth: Math.max(newWidth, MIN_WIDTH),\n\t\t\t\theight: Math.max(newHeight, MIN_HEIGHT),\n\t\t\t};\n\n\t\t\treturn {\n\t\t\t\twidth: `${sizes.width}px`,\n\t\t\t\theight: `${sizes.height}px`,\n\t\t\t\t'object-fit': (sizes.width < 100 || sizes.height < 100) ? 'cover' : 'contain',\n\t\t\t};\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t\tisForward(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.messageItem.forward.id);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tdownload()\n\t\t{\n\t\t\tif (this.file.progress !== 100 || this.canBeOpenedWithViewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = this.file.urlDownload ?? this.file.urlShow;\n\t\t\twindow.open(url, '_blank');\n\t\t},\n\t\tgetPlayCallback()\n\t\t{\n\t\t\tif (this.autoplay)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn () => {};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t@click=\"download\"\n\t\t\tclass=\"bx-im-video-item__container bx-im-video-item__scope\"\n\t\t\t:class=\"{'--with-forward': isForward}\"\n\t\t>\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"message.id\" />\n\t\t\t<SocialVideo\n\t\t\t\tv-bind=\"viewerAttributes\"\n\t\t\t\t:id=\"file.id\"\n\t\t\t\t:src=\"file.urlShow\"\n\t\t\t\t:preview=\"file.urlPreview\"\n\t\t\t\t:elementStyle=\"imageSize\"\n\t\t\t\t:autoplay=\"autoplay\"\n\t\t\t\t:showControls=\"isLoaded\"\n\t\t\t\t:playCallback=\"getPlayCallback()\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { ChatType, FileType } from 'im.v2.const';\nimport {\n\tMessageStatus,\n\tReactionList,\n\tDefaultMessageContent,\n\tMessageHeader,\n\tMessageFooter,\n} from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\n\nimport { VideoItem } from './items/video';\n\nimport '../css/video-message.css';\n\nimport type { ImModelMessage, ImModelFile, ImModelChat } from 'im.v2.model';\n\n// @vue/component\nexport const VideoMessage = {\n\tname: 'VideoMessage',\n\tcomponents: {\n\t\tReactionList,\n\t\tBaseMessage,\n\t\tMessageStatus,\n\t\tDefaultMessageContent,\n\t\tVideoItem,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tdialog(): ImModelChat\n\t\t{\n\t\t\treturn this.$store.getters['chats/get'](this.dialogId);\n\t\t},\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tonlyVideo(): boolean\n\t\t{\n\t\t\treturn this.message.text.length === 0 && this.message.attach.length === 0;\n\t\t},\n\t\thasText(): boolean\n\t\t{\n\t\t\treturn this.message.text.length > 0;\n\t\t},\n\t\thasAttach(): boolean\n\t\t{\n\t\t\treturn this.message.attach.length > 0;\n\t\t},\n\t\tisChannelPost(): boolean\n\t\t{\n\t\t\treturn [ChatType.channel, ChatType.openChannel].includes(this.dialog.type);\n\t\t},\n\t\tshowBottomContainer(): boolean\n\t\t{\n\t\t\treturn this.hasText || this.hasAttach || this.isChannelPost;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-video__container\">\n\t\t\t\t<MessageHeader :withTitle=\"false\" :item=\"item\" class=\"bx-im-message-video__header\" />\n\t\t\t\t<div class=\"bx-im-message-video__content\">\n\t\t\t\t\t<VideoItem\n\t\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div v-if=\"onlyVideo\" class=\"bx-im-message-video__message-status-container\">\n\t\t\t\t\t\t<MessageStatus :item=\"message\" :isOverlay=\"onlyVideo\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"showBottomContainer\" class=\"bx-im-message-video__bottom-container\">\n\t\t\t\t\t<DefaultMessageContent\n\t\t\t\t\t\tv-if=\"hasText || hasAttach\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t:withText=\"hasText\"\n\t\t\t\t\t\t:withAttach=\"hasAttach\"\n\t\t\t\t\t/>\n\t\t\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template #after-message>\n\t\t\t\t<div v-if=\"onlyVideo\" class=\"bx-im-message-video__reaction-list-container\">\n\t\t\t\t\t<ReactionList :messageId=\"message.id\" />\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</BaseMessage>\n\t`,\n};\n","import { AudioPlayer } from 'im.v2.component.elements';\n\nimport { MessageType } from 'im.v2.const';\nimport { ProgressBar } from './progress-bar';\n\nimport '../../css/items/audio.css';\n\nimport type { ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioItem = {\n\tname: 'AudioItem',\n\tcomponents: { AudioPlayer, ProgressBar },\n\tprops:\n\t{\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmessageId: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tfile(): ImModelFile\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tplayerBackgroundType(): string\n\t\t{\n\t\t\treturn this.messageType === MessageType.self ? 'dark' : 'light';\n\t\t},\n\t\tisLoaded(): boolean\n\t\t{\n\t\t\treturn this.file.progress === 100;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-media-audio__container\">\n\t\t\t<ProgressBar v-if=\"!isLoaded\" :item=\"file\" :messageId=\"messageId\" />\n\t\t\t<AudioPlayer\n\t\t\t\t:id=\"file.id\"\n\t\t\t\t:src=\"file.urlShow\"\n\t\t\t\t:file=\"file\"\n\t\t\t\t:timelineType=\"Math.floor(Math.random() * 5)\"\n\t\t\t\t:authorId=\"file.authorId\"\n\t\t\t\t:withContextMenu=\"false\"\n\t\t\t\t:withAvatar=\"false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { DefaultMessageContent, MessageHeader, MessageFooter } from 'im.v2.component.message.elements';\nimport { BaseMessage } from 'im.v2.component.message.base';\nimport { FileType, MessageType } from 'im.v2.const';\n\nimport { AudioItem } from './items/audio';\n\nimport '../css/audio-message.css';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\n// @vue/component\nexport const AudioMessage = {\n\tname: 'AudioMessage',\n\tcomponents: {\n\t\tBaseMessage,\n\t\tMessageHeader,\n\t\tMessageFooter,\n\t\tDefaultMessageContent,\n\t\tAudioItem,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFile(): ImModelFile\n\t\t{\n\t\t\tconst firstFileId = this.message.files[0];\n\n\t\t\treturn this.$store.getters['files/get'](firstFileId, true);\n\t\t},\n\t\tcanSetReactions(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.message.id);\n\t\t},\n\t\tmessageType(): $Values<typeof MessageType>\n\t\t{\n\t\t\treturn this.$store.getters['messages/getMessageType'](this.message.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseMessage :item=\"item\" :dialogId=\"dialogId\">\n\t\t\t<div class=\"bx-im-message-audio__container\">\n\t\t\t\t<MessageHeader :withTitle=\"withTitle\" :item=\"item\" class=\"bx-im-message-audio__header\"/>\n\t\t\t\t<AudioItem\n\t\t\t\t\t:key=\"messageFile.id\"\n\t\t\t\t\t:item=\"messageFile\"\n\t\t\t\t\t:messageId=\"message.id\"\n\t\t\t\t\t:messageType=\"messageType\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-message-audio__default-message-container\">\n\t\t\t\t<DefaultMessageContent :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t\t<MessageFooter :item=\"item\" :dialogId=\"dialogId\" />\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`,\n};\n","import { FileType } from 'im.v2.const';\nimport { UnsupportedMessage } from 'im.v2.component.message.unsupported';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { ImageMessage } from './components/image-message';\nimport { BaseFileMessage } from './components/base-file-message';\nimport { VideoMessage } from './components/video-message';\nimport { AudioMessage } from './components/audio-message';\n\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\n\nconst FileMessageType = Object.freeze({\n\timage: 'ImageMessage',\n\taudio: 'AudioMessage',\n\tvideo: 'VideoMessage',\n\tbase: 'BaseFileMessage',\n\tcollection: 'CollectionFileMessage',\n});\n\n// @vue/component\nexport const FileMessage = {\n\tname: 'FileMessage',\n\tcomponents: {\n\t\tBaseFileMessage,\n\t\tImageMessage,\n\t\tVideoMessage,\n\t\tAudioMessage,\n\t\tUnsupportedMessage,\n\t},\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithTitle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmenuIsActiveForId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tFileType: () => FileType,\n\t\tmessage(): ImModelMessage\n\t\t{\n\t\t\treturn this.item;\n\t\t},\n\t\tmessageFiles(): ImModelFile[]\n\t\t{\n\t\t\tconst files = [];\n\n\t\t\tif (this.message.files.length === 0)\n\t\t\t{\n\t\t\t\treturn files;\n\t\t\t}\n\n\t\t\tthis.message.files.forEach((fileId: number) => {\n\t\t\t\tconst file: ImModelFile = this.$store.getters['files/get'](fileId, true);\n\t\t\t\tfiles.push(file);\n\t\t\t});\n\n\t\t\treturn files;\n\t\t},\n\t\tcomponentName(): string\n\t\t{\n\t\t\tconst file = this.messageFiles[0];\n\t\t\tconst hasPreview = Boolean(file.image);\n\n\t\t\tif (file.type === FileType.image && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.image;\n\t\t\t}\n\n\t\t\tif (file.type === FileType.audio)\n\t\t\t{\n\t\t\t\treturn FileMessageType.audio;\n\t\t\t}\n\n\t\t\t// file.type value is empty for mkv files\n\t\t\tconst isVideo = file.type === FileType.video || Utils.file.getFileExtension(file.name) === 'mkv';\n\t\t\tif (isVideo && hasPreview)\n\t\t\t{\n\t\t\t\treturn FileMessageType.video;\n\t\t\t}\n\n\t\t\treturn FileMessageType.base;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component \n\t\t\t:is=\"componentName\" \n\t\t\t:item=\"message\" \n\t\t\t:dialogId=\"dialogId\" \n\t\t\t:withTitle=\"withTitle\" \n\t\t\t:menuIsActiveForId=\"menuIsActiveForId\"\n\t\t\t:withRetryButton=\"false\"\n\t\t/>\n\t`,\n};\n"],"names":["ProgressBar","name","props","item","type","Object","required","messageId","String","Number","computed","file","watch","getProgressBarManager","update","mounted","initProgressBar","beforeUnmount","removeProgressBar","methods","progress","blurElement","isImage","isVideo","progressBarManager","ProgressBarManager","container","$refs","uploadState","customConfig","hasTitle","subscribe","event","cancel","EventEmitter","emit","EventType","uploader","tempFileId","id","tempMessageId","destroy","progressBar","start","template","MAX_WIDTH","MAX_HEIGHT","MIN_WIDTH","MIN_HEIGHT","ImageItem","directives","lazyload","components","message","messageItem","imageSize","newWidth","image","width","newHeight","height","aspectRatio","Math","round","sizes","max","viewerAttributes","Utils","getViewerDataAttributes","viewerAttrs","canBeOpenedWithViewer","BX","UI","Viewer","imageTitle","size","formatFileSize","loc","isLoaded","isForward","Type","isStringFilled","forward","download","url","urlDownload","urlShow","window","open","phraseCode","replacements","$Bitrix","Loc","getMessage","ImageMessage","ReactionList","BaseMessage","MessageStatus","DefaultMessageContent","MessageHeader","MessageFooter","dialogId","withTitle","Boolean","default","menuIsActiveForId","FileType","dialog","$store","getters","onlyImage","text","length","attach","hasText","hasAttach","isChannelPost","ChatType","channel","openChannel","includes","showContextMenu","showBottomContainer","messageFile","firstFileId","files","canSetReactions","isNumber","BaseFileContextMenu","BaseMenu","constructor","PopupType","messageBaseFileMenu","diskService","DiskService","getMenuItems","getDownloadFileItem","getSaveToDisk","html","createDownloadLink","onclick","menuInstance","close","bind","save","then","Notification","Center","notify","content","context","store","BaseFileItem","fileShortName","NAME_MAX_LENGTH","getShortFileName","fileSize","iconClass","iconType","getIconTypeByFilename","created","contextMenu","openContextMenu","$emit","BaseFileMessage","onOpenContextMenu","openMenu","target","VIDEO_SIZE_TO_AUTOPLAY","DEFAULT_WIDTH","DEFAULT_HEIGHT","VideoItem","SocialVideo","autoplay","getPlayCallback","VideoMessage","onlyVideo","AudioItem","AudioPlayer","messageType","playerBackgroundType","MessageType","self","AudioMessage","FileMessageType","freeze","audio","video","base","collection","FileMessage","UnsupportedMessage","messageFiles","forEach","fileId","push","componentName","hasPreview","getFileExtension"],"mappings":"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"}