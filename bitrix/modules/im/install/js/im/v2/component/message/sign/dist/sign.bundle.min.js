this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(e,t,s,n,o,i,E,_){"use strict";const a=Object.freeze({inviteCompany:"inviteCompany",inviteEmployeeSes:"inviteEmployeeSes",inviteEmployeeTaxcom:"inviteEmployeeTaxcom",inviteEmployeeGosKey:"inviteEmployeeGosKey",inviteReviewer:"inviteReviewer",inviteEditor:"inviteEditor"});const r=Object.freeze({doneCompany:"doneCompany",doneEmployee:"doneEmployee",doneEmployeeGosKey:"doneEmployeeGosKey",doneFromAssignee:"doneFromAssignee",doneFromEditor:"doneFromEditor",doneFromReviewer:"doneFromReviewer"});const l=Object.freeze({refusedCompany:"refusedCompany",employeeStoppedToCompany:"employeeStoppedToCompany",documentStopped:"documentStopped"});const c={[a.inviteCompany]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_COMPANY_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_COMPANY_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_COMPANY_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.Primary}},[a.inviteEmployeeSes]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_SES_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_SES_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_SES_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.Primary}},[a.inviteEmployeeTaxcom]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_TAXCOM_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_TAXCOM_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_TAXCOM_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.Primary}},[a.inviteEmployeeGosKey]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_GOS_KEY_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EMPLOYEE_GOS_KEY_DESCRIPTION"),button:null},[a.inviteReviewer]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_REVIEWER_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_REVIEWER_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_REVIEWER_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.Primary}},[a.inviteEditor]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EDITOR_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EDITOR_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_INVITE_EDITOR_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.Primary}},[r.doneCompany]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_COMPANY_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_COMPANY_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_COMPANY_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,false)},color:_.ButtonColor.PrimaryBorder}},[r.doneEmployee]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_EMPLOYEE_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_EMPLOYEE_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_EMPLOYEE_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.PrimaryBorder}},[r.doneEmployeeGosKey]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_EMPLOYEE_GOS_KEY_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_EMPLOYEE_GOS_KEY_DESCRIPTION"),button:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_EMPLOYEE_GOS_KEY_BUTTON_TEXT"),callback:({user:e,document:t})=>{M(t,true)},color:_.ButtonColor.PrimaryBorder}},[r.doneFromAssignee]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_FROM_ASSIGNEE_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_FROM_ASSIGNEE_DESCRIPTION"),button:null},[r.doneFromEditor]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_FROM_EDITOR_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_FROM_EDITOR_DESCRIPTION"),button:null},[r.doneFromReviewer]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_FROM_REVIEWER_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DONE_FROM_REVIEWER_DESCRIPTION"),button:null},[l.refusedCompany]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_REFUSED_COMPANY_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_REFUSED_COMPANY_DESCRIPTION"),button:null},[l.employeeStoppedToCompany]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_EMPLOYEE_STOPPED_TO_COMPANY_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_EMPLOYEE_STOPPED_TO_COMPANY_DESCRIPTION"),button:null},[l.documentStopped]:{title:E.Loc.getMessage("IM_MESSAGE_SIGN_DOCUMENT_STOPPED_TITLE"),description:E.Loc.getMessage("IM_MESSAGE_SIGN_DOCUMENT_STOPPED_DESCRIPTION"),button:null}};function M(e,t=false){if(e.link!==undefined){if(!E.Browser.isMobile()&&t){S(e.link)}else{window.open(e.link)}}}function S(e){if(!I(e)){return}BX.SidePanel.Instance.open("sign:stub:sign-link",{width:900,cacheable:false,allowCrossOrigin:true,allowCrossDomain:true,allowChangeHistory:false,newWindowUrl:e,copyLinkLabel:true,newWindowLabel:true,loader:"/bitrix/js/intranet/sidepanel/bindings/images/sign_mask.svg",label:{text:E.Loc.getMessage("IM_MESSAGE_SIGN_SIDEPANEL_BTN_SIGN"),bgColor:"#C48300"},async contentCallback(t){return BX.Runtime.loadExtension("sign.v2.b2e.sign-link").then((()=>{const s=/\/sign\/link\/member\/(\d+)\//i.exec(e);return new BX.Sign.V2.B2e.SignLink({memberId:s[1],slider:t}).render()}))}})}function I(e){return/^\/sign\/link\/member\/\d+\/$/.test(e)}const g={STAGE_ID:"stageId",USER:"user",DOCUMENT:"document",HELP_ARTICLE:"helpArticle"};const u={name:"SignMessage",components:{ButtonComponent:_.Button,BaseMessage:n.BaseMessage,DefaultMessage:i.DefaultMessage,MessageStatus:o.MessageStatus},props:{item:{type:Object,required:true},dialogId:{type:String,required:true}},computed:{message(){return this.item},ButtonSize:()=>_.ButtonSize,componentParams(){return this.message.componentParams},stageId(){var e;return(e=this.componentParams[g.STAGE_ID])!=null?e:""},user(){return this.componentParams[g.USER]},document(){return this.componentParams[g.DOCUMENT]},helpArticle(){var e;return(e=this.componentParams[g.HELP_ARTICLE])!=null?e:""},signData(){const e=c[this.stageId];if(!e){console.error("SignMessage: signData is undefined.")}return e},title(){var e,t;return(e=(t=this.signData)==null?void 0:t.title)!=null?e:""},description(){var e,t;return(e=(t=this.signData)==null?void 0:t.description)!=null?e:""},button(){var e;return(e=this.signData)==null?void 0:e.button},isAwaitSign(){return Object.values(a).includes(this.stageId)},isSuccessSign(){return Object.values(r).includes(this.stageId)},isFailureSign(){return Object.values(l).includes(this.stageId)},isSelfMessage(){return this.message.authorId===t.Core.getUserId()},containerClasses(){return{"--self":this.isSelfMessage,"--await":this.isAwaitSign,"--success":this.isSuccessSign,"--failure":this.isFailureSign}}},methods:{replacePhrase(e){var t,n,o;let i=e!=null?e:"";const _=s.Utils.user.getProfileLink((t=this.user)==null?void 0:t.id);const a=`javascript: BX.Helper?.show('redirect=detail&code=${this.helpArticle}')`;const r="bx-im-message-sign__link";const l="bx-im-message-sign__document";const c={"#DOCUMENT_NAME#":`<span class="${l}">${E.Text.encode((n=this.document)==null?void 0:n.name)}</span>`,"#USER_LINK#":`<a href="${_}" class="${r}">${E.Text.encode((o=this.user)==null?void 0:o.name)}</a>`,"[helpdesklink]":`<a href="${a}" class="${r}">`,"[/helpdesklink]":"</a>"};Object.keys(c).forEach((e=>{i=i.replaceAll(e,c[e])}));return i}},template:`\n\t\t<DefaultMessage v-if="!signData" :item="item" :dialogId="dialogId" />\n\t\t<BaseMessage\n\t\t\tv-else\n\t\t\t:dialogId="dialogId"\n\t\t\t:item="item"\n\t\t\t:withBackground="false"\n\t\t\tclass="bx-im-message-sign__scope"\n\t\t>\n\t\t\t<div :class="['bx-im-message-sign__container', containerClasses]">\n\t\t\t\t<div class="bx-im-message-sign__image" />\n\t\t\t\t<div class="bx-im-message-sign__content">\n\t\t\t\t\t<div class="bx-im-message-sign__title">\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="bx-im-message-sign__description" v-html="replacePhrase(description)" />\n\t\t\t\t\t<div class="bx-im-message-sign__buttons_container">\n\t\t\t\t\t\t<ButtonComponent\n\t\t\t\t\t\t\tv-if="button"\n\t\t\t\t\t\t\t:size="ButtonSize.L"\n\t\t\t\t\t\t\tisRounded\n\t\t\t\t\t\t\t:text="button.text"\n\t\t\t\t\t\t\t:color="button.color"\n\t\t\t\t\t\t\t@click="button.callback({ user, document })"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-message-sign__status_container">\n\t\t\t\t\t<MessageStatus :item="message" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BaseMessage>\n\t`};e.SignMessage=u;e.Await=a;e.Success=r;e.Failure=l})(this.BX.Messenger.v2.Component.Message=this.BX.Messenger.v2.Component.Message||{},BX.Messenger.v2.Application,BX.Messenger.v2.Lib,BX.Messenger.v2.Component.Message,BX.Messenger.v2.Component.Message,BX.Messenger.v2.Component.Message,BX,BX.Messenger.v2.Component.Elements);
//# sourceMappingURL=sign.bundle.map.js